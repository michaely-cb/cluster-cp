---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.14.0
  name: namespacereservations.jobs.cerebras.com
spec:
  group: jobs.cerebras.com
  names:
    kind: NamespaceReservation
    listKind: NamespaceReservationList
    plural: namespacereservations
    singular: namespacereservation
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.systems
      name: systems
      type: string
    - jsonPath: .status.nodegroups
      name: nodegroups
      priority: 1
      type: string
    - jsonPath: .status.nodes
      name: nodes
      priority: 1
      type: string
    - jsonPath: .status.currentResourceSpec.parallelExecuteCount
      name: executes
      type: string
    - jsonPath: .status.currentResourceSpec.parallelCompileCount
      name: compiles
      type: string
    - jsonPath: .status.currentResourceSpec.largeMemoryRackCount
      name: largeMemRacks
      type: string
    - jsonPath: .status.currentResourceSpec.xlargeMemoryRackCount
      name: xlargeMemRacks
      type: string
    name: v1
    schema:
      openAPIV3Schema:
        description: NamespaceReservation is the Schema for the Namespace API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            properties:
              requestParameters:
                description: |-
                  RequestParams are user-friendly request details. If submitted, the reconciler will update the System request with
                  the translated RequestParams request.
                properties:
                  activationNodeNames:
                    description: ActivationNodeNames specifies activation nodes to
                      add/remove/set in debug mode
                    items:
                      type: string
                    type: array
                  autoSelectActivationNodes:
                    description: |-
                      AutoSelectActivationNodes automatically selects activation nodes to match systems
                      with best affinity coverage in respective resource stamps
                    type: boolean
                  autoSelectInferenceDriverNodes:
                    description: |-
                      AutoSelectInferenceDriverNodes automatically selects inference driver node in the possible
                      resource stamp with the most systems
                    type: boolean
                  coordinatorNodeNames:
                    description: CoordinatorNodeNames specifies coordinator nodes
                      to add/remove/set in debug mode
                    items:
                      type: string
                    type: array
                  inferenceDriverNodeNames:
                    description: InferenceDriverNodeNames specifies inference driver
                      nodes to add/remove/set in debug mode
                    items:
                      type: string
                    type: array
                  largeMemoryRackCount:
                    description: LargeMemoryRackCount are the number of fully-populated
                      large (1TB) memx racks for the system to reserve.
                    minimum: 0
                    type: integer
                  managementNodeNames:
                    description: ManagementNodeNames specifies management nodes to
                      add/remove/set in debug mode
                    items:
                      type: string
                    type: array
                  nodegroupNames:
                    description: NodegroupNames specifies nodegroups to add/remove/set
                      in debug mode
                    items:
                      type: string
                    type: array
                  parallelCompileCount:
                    description: |-
                      ParallelCompileCount is an estimate of the number of parallel compiles which can run in parallel using default
                      memory settings. Implies some number of management nodes reserved.
                    minimum: 0
                    type: integer
                  parallelExecuteCount:
                    description: |-
                      ParallelExecuteCount is an estimate for the number of a parallel trains which can run in parallel using default
                      memory settings. Implies some number of management nodes reserved and some number of fully-populated memx racks.
                    minimum: 0
                    type: integer
                  suppressAffinityErrors:
                    description: SuppressAffinityErrors ignore errors from CS port
                      affinity requirements
                    type: boolean
                  systemCount:
                    description: SystemCount specifies number of systems to allocate
                      to the session.
                    type: integer
                  systemNames:
                    description: SystemNames specifies systems to add/remove/set in
                      debug mode
                    items:
                      type: string
                    type: array
                  updateMode:
                    default: SetResourceSpec
                    description: |-
                      UpdateMode defines how the RequestParams will be reconciled. SetResourceSpecMode replaces the previous RequestParams
                      and re-evaluates the given '*Count' Params to derive a new resource allocation meeting the Count criterias.
                      SetResourceSpecDryRun evaluates the '*Count' params same as SetResourceSpecMode but does not apply them and
                      only updates the UpdateHistory with a record containing *Count params representing the resource capabilities
                      of the session after the proposed change and the *Name params with the final names if the Dryrun change was effective.
                      Debug modes add/remove/set specific resources reference in the *Name params. *Name params are
                      ignored in SetCapabilities mode and *Count params are ignored in debug modes.
                    enum:
                    - ""
                    - SetResourceSpec
                    - SetResourceSpecDryRun
                    - DebugRemove
                    - DebugRemoveAll
                    - DebugAppend
                    - DebugSet
                    type: string
                  xlargeMemoryRackCount:
                    description: XLargeMemoryRackCount are the number of fully-populated
                      xlarge (2.3TB) memx racks for the system to reserve.
                    minimum: 0
                    type: integer
                required:
                - updateMode
                type: object
              requestUid:
                description: |-
                  RequestUid is a random id used for k8s client to track the progress of their request. Clients should not update
                  an NSR.spec with a new request until the spec.RequestUid == status.requestHistory[0].requestId so as not to overwrite
                  another client's reservation progress.
                type: string
            type: object
          status:
            properties:
              currentResourceSpec:
                description: Current estimate of resources
                properties:
                  largeMemoryRackCount:
                    description: LargeMemoryRackCount are the number of fully-populated
                      large (1TB) memx racks for the system to reserve.
                    type: integer
                  parallelCompileCount:
                    description: |-
                      ParallelCompileCount is an estimate of the number of parallel compiles which can run in parallel using default
                      memory settings
                    type: integer
                  parallelExecuteCount:
                    description: |-
                      ParallelExecuteCount is an estimate for the number of a parallel trains which can run in parallel using default
                      memory settings.
                    type: integer
                  xlargeMemoryRackCount:
                    description: XLargeMemoryRackCount are the number of fully-populated
                      xlarge (2.3TB) memx racks for the system to reserve.
                    type: integer
                type: object
              grantedRequest:
                description: GrantedRequest is a copy of the last granted ReservationRequest
                  reflected in the reserved resources.
                properties:
                  requestParameters:
                    description: |-
                      RequestParams are user-friendly request details. If submitted, the reconciler will update the System request with
                      the translated RequestParams request.
                    properties:
                      activationNodeNames:
                        description: ActivationNodeNames specifies activation nodes
                          to add/remove/set in debug mode
                        items:
                          type: string
                        type: array
                      autoSelectActivationNodes:
                        description: |-
                          AutoSelectActivationNodes automatically selects activation nodes to match systems
                          with best affinity coverage in respective resource stamps
                        type: boolean
                      autoSelectInferenceDriverNodes:
                        description: |-
                          AutoSelectInferenceDriverNodes automatically selects inference driver node in the possible
                          resource stamp with the most systems
                        type: boolean
                      coordinatorNodeNames:
                        description: CoordinatorNodeNames specifies coordinator nodes
                          to add/remove/set in debug mode
                        items:
                          type: string
                        type: array
                      inferenceDriverNodeNames:
                        description: InferenceDriverNodeNames specifies inference
                          driver nodes to add/remove/set in debug mode
                        items:
                          type: string
                        type: array
                      largeMemoryRackCount:
                        description: LargeMemoryRackCount are the number of fully-populated
                          large (1TB) memx racks for the system to reserve.
                        minimum: 0
                        type: integer
                      managementNodeNames:
                        description: ManagementNodeNames specifies management nodes
                          to add/remove/set in debug mode
                        items:
                          type: string
                        type: array
                      nodegroupNames:
                        description: NodegroupNames specifies nodegroups to add/remove/set
                          in debug mode
                        items:
                          type: string
                        type: array
                      parallelCompileCount:
                        description: |-
                          ParallelCompileCount is an estimate of the number of parallel compiles which can run in parallel using default
                          memory settings. Implies some number of management nodes reserved.
                        minimum: 0
                        type: integer
                      parallelExecuteCount:
                        description: |-
                          ParallelExecuteCount is an estimate for the number of a parallel trains which can run in parallel using default
                          memory settings. Implies some number of management nodes reserved and some number of fully-populated memx racks.
                        minimum: 0
                        type: integer
                      suppressAffinityErrors:
                        description: SuppressAffinityErrors ignore errors from CS
                          port affinity requirements
                        type: boolean
                      systemCount:
                        description: SystemCount specifies number of systems to allocate
                          to the session.
                        type: integer
                      systemNames:
                        description: SystemNames specifies systems to add/remove/set
                          in debug mode
                        items:
                          type: string
                        type: array
                      updateMode:
                        default: SetResourceSpec
                        description: |-
                          UpdateMode defines how the RequestParams will be reconciled. SetResourceSpecMode replaces the previous RequestParams
                          and re-evaluates the given '*Count' Params to derive a new resource allocation meeting the Count criterias.
                          SetResourceSpecDryRun evaluates the '*Count' params same as SetResourceSpecMode but does not apply them and
                          only updates the UpdateHistory with a record containing *Count params representing the resource capabilities
                          of the session after the proposed change and the *Name params with the final names if the Dryrun change was effective.
                          Debug modes add/remove/set specific resources reference in the *Name params. *Name params are
                          ignored in SetCapabilities mode and *Count params are ignored in debug modes.
                        enum:
                        - ""
                        - SetResourceSpec
                        - SetResourceSpecDryRun
                        - DebugRemove
                        - DebugRemoveAll
                        - DebugAppend
                        - DebugSet
                        type: string
                      xlargeMemoryRackCount:
                        description: XLargeMemoryRackCount are the number of fully-populated
                          xlarge (2.3TB) memx racks for the system to reserve.
                        minimum: 0
                        type: integer
                    required:
                    - updateMode
                    type: object
                  requestUid:
                    description: |-
                      RequestUid is a random id used for k8s client to track the progress of their request. Clients should not update
                      an NSR.spec with a new request until the spec.RequestUid == status.requestHistory[0].requestId so as not to overwrite
                      another client's reservation progress.
                    type: string
                type: object
              nodegroups:
                items:
                  type: string
                type: array
              nodes:
                items:
                  type: string
                type: array
              systems:
                items:
                  type: string
                type: array
              updateHistory:
                description: UpdateHistory is the last few requests submitted to the
                  NSR.spec
                items:
                  properties:
                    message:
                      description: Message is populated with details of the request
                        attempt failure.
                      type: string
                    reconcileTimestamp:
                      format: date-time
                      type: string
                    request:
                      properties:
                        requestParameters:
                          description: |-
                            RequestParams are user-friendly request details. If submitted, the reconciler will update the System request with
                            the translated RequestParams request.
                          properties:
                            activationNodeNames:
                              description: ActivationNodeNames specifies activation
                                nodes to add/remove/set in debug mode
                              items:
                                type: string
                              type: array
                            autoSelectActivationNodes:
                              description: |-
                                AutoSelectActivationNodes automatically selects activation nodes to match systems
                                with best affinity coverage in respective resource stamps
                              type: boolean
                            autoSelectInferenceDriverNodes:
                              description: |-
                                AutoSelectInferenceDriverNodes automatically selects inference driver node in the possible
                                resource stamp with the most systems
                              type: boolean
                            coordinatorNodeNames:
                              description: CoordinatorNodeNames specifies coordinator
                                nodes to add/remove/set in debug mode
                              items:
                                type: string
                              type: array
                            inferenceDriverNodeNames:
                              description: InferenceDriverNodeNames specifies inference
                                driver nodes to add/remove/set in debug mode
                              items:
                                type: string
                              type: array
                            largeMemoryRackCount:
                              description: LargeMemoryRackCount are the number of
                                fully-populated large (1TB) memx racks for the system
                                to reserve.
                              minimum: 0
                              type: integer
                            managementNodeNames:
                              description: ManagementNodeNames specifies management
                                nodes to add/remove/set in debug mode
                              items:
                                type: string
                              type: array
                            nodegroupNames:
                              description: NodegroupNames specifies nodegroups to
                                add/remove/set in debug mode
                              items:
                                type: string
                              type: array
                            parallelCompileCount:
                              description: |-
                                ParallelCompileCount is an estimate of the number of parallel compiles which can run in parallel using default
                                memory settings. Implies some number of management nodes reserved.
                              minimum: 0
                              type: integer
                            parallelExecuteCount:
                              description: |-
                                ParallelExecuteCount is an estimate for the number of a parallel trains which can run in parallel using default
                                memory settings. Implies some number of management nodes reserved and some number of fully-populated memx racks.
                              minimum: 0
                              type: integer
                            suppressAffinityErrors:
                              description: SuppressAffinityErrors ignore errors from
                                CS port affinity requirements
                              type: boolean
                            systemCount:
                              description: SystemCount specifies number of systems
                                to allocate to the session.
                              type: integer
                            systemNames:
                              description: SystemNames specifies systems to add/remove/set
                                in debug mode
                              items:
                                type: string
                              type: array
                            updateMode:
                              default: SetResourceSpec
                              description: |-
                                UpdateMode defines how the RequestParams will be reconciled. SetResourceSpecMode replaces the previous RequestParams
                                and re-evaluates the given '*Count' Params to derive a new resource allocation meeting the Count criterias.
                                SetResourceSpecDryRun evaluates the '*Count' params same as SetResourceSpecMode but does not apply them and
                                only updates the UpdateHistory with a record containing *Count params representing the resource capabilities
                                of the session after the proposed change and the *Name params with the final names if the Dryrun change was effective.
                                Debug modes add/remove/set specific resources reference in the *Name params. *Name params are
                                ignored in SetCapabilities mode and *Count params are ignored in debug modes.
                              enum:
                              - ""
                              - SetResourceSpec
                              - SetResourceSpecDryRun
                              - DebugRemove
                              - DebugRemoveAll
                              - DebugAppend
                              - DebugSet
                              type: string
                            xlargeMemoryRackCount:
                              description: XLargeMemoryRackCount are the number of
                                fully-populated xlarge (2.3TB) memx racks for the
                                system to reserve.
                              minimum: 0
                              type: integer
                          required:
                          - updateMode
                          type: object
                        requestUid:
                          description: |-
                            RequestUid is a random id used for k8s client to track the progress of their request. Clients should not update
                            an NSR.spec with a new request until the spec.RequestUid == status.requestHistory[0].requestId so as not to overwrite
                            another client's reservation progress.
                          type: string
                      type: object
                    succeeded:
                      description: Succeeded is true if the request was granted
                      type: boolean
                  required:
                  - request
                  - succeeded
                  type: object
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
