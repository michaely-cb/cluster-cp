{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "target": {
          "limit": 100,
          "matchAny": false,
          "tags": [],
          "type": "dashboard"
        },
        "type": "dashboard"
      }
    ]
  },
  "description": "",
  "editable": false,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": 22316,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 204,
      "panels": [],
      "title": "Session Resources",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false,
            "minWidth": 100
          },
          "links": [
            {
              "targetBlank": true,
              "title": "System Health Dashboard",
              "url": "d/df3huubwl3hfkd-internal/system-health-details?from=${__from}&to=${__to}&var-system=${__data.fields.system}"
            }
          ],
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "system"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 347
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 1
      },
      "id": 213,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "editorMode": "code",
          "exemplar": false,
          "expr": "system_label{namespace=\"$session\"} * on (system) group_left (configName) system_wse_config_info",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Systems",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": true,
              "instance": true,
              "job": true,
              "namespace": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 6,
              "configName": 2,
              "instance": 3,
              "job": 4,
              "namespace": 5,
              "system": 1
            },
            "renameByName": {
              "Value": "Count",
              "configName": "Config",
              "system": "System"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "text",
            "mode": "fixed"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Config"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 285
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Value"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 80
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 7,
        "x": 12,
        "y": 1
      },
      "id": 214,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "editorMode": "code",
          "exemplar": false,
          "expr": "count by (configName) (system_label{namespace=\"$session\"} * on (system) group_left (configName) system_wse_config_info)",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Number of Systems per Config",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value": "Count",
              "configName": "Config"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 5,
        "x": 19,
        "y": 1
      },
      "id": 215,
      "options": {
        "infinitePan": false,
        "inlineEditing": false,
        "panZoom": false,
        "root": {
          "background": {
            "color": {
              "fixed": "transparent"
            }
          },
          "border": {
            "color": {
              "fixed": "dark-green"
            }
          },
          "constraint": {
            "horizontal": "left",
            "vertical": "top"
          },
          "elements": [],
          "name": "Element 1752301711523",
          "oneClickMode": "off",
          "placement": {
            "height": 100,
            "left": 0,
            "rotation": 0,
            "top": 0,
            "width": 100
          },
          "type": "frame"
        },
        "showAdvancedTypes": false
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "refId": "A"
        }
      ],
      "title": "",
      "transparent": true,
      "type": "canvas"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [
            {
              "options": {
                "from": 0,
                "result": {
                  "index": 0,
                  "text": "Standard"
                },
                "to": 800
              },
              "type": "range"
            },
            {
              "options": {
                "from": 800,
                "result": {
                  "index": 1,
                  "text": "Large"
                },
                "to": 1800
              },
              "type": "range"
            },
            {
              "options": {
                "from": 1800,
                "result": {
                  "index": 2,
                  "text": "XLarge"
                },
                "to": 5000
              },
              "type": "range"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 4,
        "x": 0,
        "y": 9
      },
      "id": 207,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "max by (group) (node:namespace_group_role_info{namespace=\"$session\"} * on (internal_ip) group_left () label_replace(node_memory_MemTotal_bytes, \"internal_ip\", \"$1\", \"instance\", \"(.*):9100\")) / (1024*1024*1024)",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "B"
        }
      ],
      "title": "Assigned Nodegroups",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": false,
              "__name__": true,
              "container": true,
              "customresource_group": true,
              "customresource_kind": true,
              "customresource_version": true,
              "endpoint": true,
              "group": false,
              "instance": true,
              "job": true,
              "name": true,
              "namespace": true,
              "pod": true,
              "prometheus": true,
              "service": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value": "Size",
              "group": "Nodegroup"
            }
          }
        },
        {
          "id": "sortBy",
          "options": {
            "fields": {},
            "sort": [
              {
                "desc": false,
                "field": "Size"
              }
            ]
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Node Health Details",
              "url": "d/eehh0zde6wo3ka-internal/node-health-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}"
            }
          ],
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 5,
        "x": 4,
        "y": 9
      },
      "id": 206,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "editorMode": "code",
          "exemplar": false,
          "expr": "node:namespace_group_role_info{namespace=\"$session\"} * on (node) group_left (role) group by (node, role) (job_operator_node_role{role=\"management\"})",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Management Nodes",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": true,
              "namespace": true,
              "role": true,
              "thanos_ruler_replica": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {}
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Node Health Details",
              "url": "d/eehh0zde6wo3ka-internal/node-health-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}"
            }
          ],
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 5,
        "x": 9,
        "y": 9
      },
      "id": 208,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "editorMode": "code",
          "exemplar": false,
          "expr": "node:namespace_group_role_info{namespace=\"$session\"} * on (node) group_left (role) group by (node, role) (job_operator_node_role{role=\"activation\"})",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "AX Nodes",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": true,
              "__name__": true,
              "container": true,
              "customresource_group": true,
              "customresource_kind": true,
              "customresource_version": true,
              "endpoint": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "node": false,
              "pod": true,
              "prometheus": true,
              "role": true,
              "service": true,
              "thanos_ruler_replica": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {}
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Node Health Details",
              "url": "d/eehh0zde6wo3ka-internal/node-health-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}"
            }
          ],
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 5,
        "x": 14,
        "y": 9
      },
      "id": 209,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "editorMode": "code",
          "exemplar": false,
          "expr": "node:namespace_group_role_info{namespace=\"$session\"} * on (node) group_left (role) group by (node, role) (job_operator_node_role{role=\"worker\"})",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Worker Nodes",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": true,
              "__name__": true,
              "container": true,
              "customresource_group": true,
              "customresource_kind": true,
              "customresource_version": true,
              "endpoint": true,
              "group": true,
              "instance": true,
              "internal_ip": true,
              "job": true,
              "namespace": true,
              "node": false,
              "pod": true,
              "prometheus": true,
              "role": true,
              "service": true,
              "thanos_ruler_replica": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {}
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Node Health Details",
              "url": "d/eehh0zde6wo3ka-internal/node-health-details?from=${__from}&to=${__to}&var-node=${__data.fields.nodename}"
            }
          ],
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 5,
        "x": 19,
        "y": 9
      },
      "id": 216,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "editorMode": "code",
          "exemplar": false,
          "expr": "cerebras_session_member{exported_namespace=\"job-operator\"} * on (instance) group_left (nodename) node_uname_info",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "User Nodes",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": true,
              "__name__": true,
              "cluster": true,
              "container": true,
              "customresource_group": true,
              "customresource_kind": true,
              "customresource_version": true,
              "endpoint": true,
              "exported_namespace": true,
              "group": true,
              "instance": true,
              "internal_ip": true,
              "job": true,
              "namespace": true,
              "node": false,
              "pod": true,
              "prometheus": true,
              "role": true,
              "service": true,
              "thanos_ruler_replica": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value": "",
              "instance": "",
              "nodename": "Nodes"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 17
      },
      "id": 200,
      "panels": [],
      "title": "Job Queue",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "(Max) Number of systems used by jobs.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 100,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "stepBefore",
            "lineWidth": 0,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "decimals": 0,
          "links": [
            {
              "targetBlank": true,
              "title": "WsJob Dashboard",
              "url": "/d/WebHNShVz/wsjob-dashboard?from=${__from}&to=${__to}&var-wsjob=${__field.labels.name}"
            },
            {
              "targetBlank": true,
              "title": "Job Debug Dashboard",
              "url": "/d/debcs3ata3ym8a-internal/job-debug?from=${__from}&to=${__to}&var-wsjob=${__field.labels.name}"
            },
            {
              "targetBlank": true,
              "title": "Workflow Overview Dashboard",
              "url": "/d/fednhre8e41s0d-internal/workflow-overview?from=${__from}&to=${__to}&var-wflow=${__field.labels.cerebras_workflow_id}"
            }
          ],
          "mappings": [],
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": []
          },
          "unit": "none"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 17,
        "w": 24,
        "x": 0,
        "y": 18
      },
      "id": 203,
      "options": {
        "legend": {
          "calcs": [
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true,
          "sortBy": "Max",
          "sortDesc": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "uid": "$datasource"
          },
          "editorMode": "code",
          "expr": "count by (name, labels_k8s_cerebras_com_Model) (group by (name, system) (wsjob_system_grant{namespace=~\"$session\"})) * on (name) group_left(labels_k8s_cerebras_com_Model, cerebras_workflow_id) group by(name, labels_k8s_cerebras_com_Model, cerebras_workflow_id) (wsjob_annotation{job_type!=\"compile\", namespace=~\"$session\"})",
          "format": "time_series",
          "intervalFactor": 2,
          "legendFormat": "{{labels_k8s_cerebras_com_Model}} / {{cerebras_workflow_id}} / {{name}}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "CSX Jobs Histogram",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "filterable": true,
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "WsJob Dashboard",
              "url": "/d/WebHNShVz/wsjob-dashboard?from=${__from}&to=${__to}&var-wsjob=${__data.fields[\"job name\"]}"
            },
            {
              "targetBlank": true,
              "title": "Job Debug Dashboard",
              "url": "/d/debcs3ata3ym8a-internal/job-debug?from=${__from}&to=${__to}&var-wsjob=${__data.fields[\"job name\"]}"
            },
            {
              "targetBlank": true,
              "title": "Workflow Overview Dashboard",
              "url": "/d/fednhre8e41s0d-internal/workflow-overview?from=${__from}&to=${__to}&var-wflow=${__data.fields[\"workflow name\"]}"
            }
          ],
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "name"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 270
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "start"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 190
              },
              {
                "id": "unit",
                "value": "dateTimeAsSystem"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "system_count"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 138
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": ""
            },
            "properties": []
          },
          {
            "matcher": {
              "id": "byName",
              "options": "workflow name"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 274
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "job name"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 286
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 19,
        "w": 24,
        "x": 0,
        "y": 35
      },
      "id": 202,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "wsjob_annotation{namespace=\"$session\", end=\"\"} or (wsjob_annotation{namespace=\"$session\"} unless (wsjob_annotation{namespace=\"$session\"} @ ${__from:date:seconds}))",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "CSX Jobs - Running, Queued, or Completed during time range",
      "transformations": [
        {
          "id": "extractFields",
          "options": {
            "format": "json",
            "jsonPaths": [
              {
                "alias": "Volume 0",
                "path": "[0].mountPath"
              },
              {
                "alias": "Volume 1",
                "path": "[1].mountPath"
              },
              {
                "alias": "Volume 2",
                "path": "[2].mountPath"
              }
            ],
            "keepTime": false,
            "replace": false,
            "source": "user_volumes"
          }
        },
        {
          "id": "calculateField",
          "options": {
            "alias": "Volume Mounts",
            "mode": "reduceRow",
            "reduce": {
              "include": [
                "Volume 0",
                "Volume 1",
                "Volume 2",
                "Volume 3"
              ],
              "reducer": "uniqueValues"
            },
            "replaceFields": false
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "BUILD_BALANCED_BR_TREE": true,
              "Time": true,
              "Value": true,
              "Volume 0": true,
              "Volume 1": true,
              "Volume 2": true,
              "Volume 3": true,
              "__name__": true,
              "container": true,
              "customresource_group": true,
              "customresource_kind": true,
              "customresource_version": true,
              "endpoint": true,
              "instance": true,
              "job": true,
              "k8s_cerebras_com_job_mode": true,
              "k8s_cerebras_com_wsjob_job_type": true,
              "labels_k8s_cerebras_com_Model": true,
              "labels_k8s_cerebras_com_purpose": true,
              "labels_k8s_cerebras_com_user": false,
              "namespace": true,
              "node_groups": true,
              "pod": true,
              "prometheus": true,
              "service": true,
              "systems": true,
              "user_volumes": true,
              "username": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 7,
              "Value": 21,
              "Volume 0": 29,
              "Volume 1": 30,
              "Volume 2": 31,
              "Volume Mounts": 32,
              "__name__": 22,
              "cerebras_workflow_id": 0,
              "container": 8,
              "current_status": 2,
              "customresource_group": 9,
              "customresource_kind": 10,
              "customresource_version": 11,
              "end": 4,
              "endpoint": 12,
              "instance": 13,
              "job": 14,
              "job_type": 15,
              "k8s_cerebras_com_job_mode": 16,
              "k8s_cerebras_com_wsjob_cancel_reason": 33,
              "k8s_cerebras_com_wsjob_job_type": 17,
              "labels_k8s_cerebras_com_purpose": 23,
              "labels_k8s_cerebras_com_user": 24,
              "name": 1,
              "namespace": 5,
              "node_groups": 25,
              "pod": 18,
              "prometheus": 26,
              "service": 19,
              "start": 3,
              "system_count": 20,
              "systems": 27,
              "user_volumes": 28,
              "username": 6
            },
            "renameByName": {
              "Volume Mounts": "",
              "cerebras_workflow_id": "workflow name",
              "k8s_cerebras_com_wsjob_cancel_reason": "Cancel reason",
              "name": "job name"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 54
      },
      "id": 34,
      "panels": [],
      "title": "Selected Session - Systems - Overview",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 55
      },
      "id": 188,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "Summary of system health for the selected session",
        "mode": "markdown"
      },
      "pluginVersion": "11.3.1",
      "title": "",
      "type": "text"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "status of all systems at the last timestamp of the selected range ",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "green",
            "mode": "fixed"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "status"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "0": {
                        "color": "#bf1aef",
                        "index": 2,
                        "text": "UNKNOWN"
                      },
                      "1": {
                        "color": "green",
                        "index": 3,
                        "text": "OK"
                      },
                      "2": {
                        "color": "dark-yellow",
                        "index": 4,
                        "text": "DEGRADED"
                      },
                      "3": {
                        "color": "red",
                        "index": 5,
                        "text": "CRITICAL"
                      },
                      "4": {
                        "color": "#18dbd680",
                        "index": 6,
                        "text": "CRITICAL_EMERGENCY_SHUTDOWN"
                      },
                      "5": {
                        "color": "super-light-blue",
                        "index": 7,
                        "text": "STANDBY"
                      },
                      "6": {
                        "color": "#0d7cea",
                        "index": 8,
                        "text": "PENDING_STANDBY"
                      },
                      "7": {
                        "color": "#12e280",
                        "index": 9,
                        "text": "PENDING_ACTIVE"
                      },
                      "8": {
                        "color": "#dbaa12",
                        "index": 10,
                        "text": "MISSING"
                      },
                      "9": {
                        "color": "#410be3",
                        "index": 11,
                        "text": "NO_POWER"
                      },
                      "10": {
                        "color": "#f1750a",
                        "index": 12,
                        "text": "HARDWARE_ERROR"
                      },
                      "11": {
                        "color": "super-light-orange",
                        "index": 13,
                        "text": "DISABLED"
                      },
                      "12": {
                        "color": "super-light-red",
                        "index": 14,
                        "text": "UNAVAILABLE"
                      },
                      "13": {
                        "color": "#be2b2b",
                        "index": 15,
                        "text": "UPDATING_SW"
                      },
                      "14": {
                        "color": "purple",
                        "index": 16,
                        "text": "PUMP_BLEEDING"
                      },
                      "15": {
                        "color": "blue",
                        "index": 17,
                        "text": "SERVICES_NOT_READY"
                      },
                      "16": {
                        "color": "light-blue",
                        "index": 18,
                        "text": "FPGA_UPDATE"
                      },
                      "17": {
                        "color": "#2eddcf",
                        "index": 19,
                        "text": "PUMP_LIMPING"
                      },
                      "18": {
                        "color": "#8ced0e",
                        "index": 20,
                        "text": "DOOR_OPEN"
                      },
                      "19": {
                        "color": "#0ecef8",
                        "index": 21,
                        "text": "DOOR_CLOSED"
                      },
                      "20": {
                        "index": 22,
                        "text": "NON_STANDARD"
                      },
                      "-1": {
                        "color": "#11469a",
                        "index": 1,
                        "text": "ADMIN_SVC_UNKNOWN"
                      },
                      "-2": {
                        "color": "#ed0a0a",
                        "index": 0,
                        "text": "SYSTEM_NOT_REACHABLE"
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 12,
        "w": 3,
        "x": 0,
        "y": 57
      },
      "id": 186,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "(count((system_overall_health{system=~\"$systems\"} == 1) or (system_overall_health{system=~\"$systems\"} == 2) or (system_overall_health{system=~\"$systems\"} == -1))) or vector(0)",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "OK"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count(system_label{system=~\"$systems\"})",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "All"
        }
      ],
      "title": "System status buckets",
      "transformations": [
        {
          "id": "merge",
          "options": {}
        },
        {
          "id": "calculateField",
          "options": {
            "alias": "Error",
            "binary": {
              "left": "Value #All",
              "operator": "-",
              "reducer": "sum",
              "right": "Value #OK"
            },
            "mode": "binary",
            "reduce": {
              "reducer": "sum"
            }
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Value #All": true,
              "__name__": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "prometheus": true,
              "system": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value #OK": "OK",
              "system": ""
            }
          }
        }
      ],
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "green",
            "mode": "fixed"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Utilized Percent"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 12,
        "w": 4,
        "x": 3,
        "y": 57
      },
      "id": 198,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "center",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "value_and_name",
        "wideLayout": false
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "clamp_max(avg_over_time((sum((group(wsjob_system_grant{system=~\"$systems\"}) by (system)) or (sum(0*system_label) by (system))) / count(group(namespace_reserved_system{system=~\"$systems\"}) by (system)))[$__range:$__rate_interval]) *100, 100)",
          "format": "time_series",
          "instant": false,
          "legendFormat": "Utilized Percent",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "expr": "avg_over_time((sum(group(wsjob_system_grant{system=~\"$systems\"}) by (system)) or sum(sum(system_label*0) by (system)))[$__range:$__rate_interval]) * (${__to:date:seconds}-${__from:date:seconds})/3600",
          "hide": false,
          "instant": false,
          "legendFormat": "Utilized Hours",
          "range": true,
          "refId": "B"
        }
      ],
      "title": "Utilization",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "status of all systems at the last timestamp of the selected range ",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 12,
        "w": 17,
        "x": 7,
        "y": 57
      },
      "id": 115,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "expr": "sum(max(system_overall_health{system=~\"$systems\"}) by (system) == bool 2) + sum(max(system_overall_health{system=~\"$systems\"}) by (system) == bool 1)",
          "hide": false,
          "legendFormat": "OK",
          "range": true,
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "expr": "sum(group((system_overall_health{system=~\"$systems\"} != 1) and (system_overall_health{system=~\"$systems\"} != 2) and (system_overall_health{system=~\"$systems\"} != -1)) by (system) or group by (system) (system_overall_health{system=~\"$systems\"}) != bool(1))",
          "hide": false,
          "legendFormat": "Error",
          "range": true,
          "refId": "C"
        }
      ],
      "title": "System Status over time",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 69
      },
      "id": 159,
      "panels": [],
      "title": "Selected Session - Nodes - Overview",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 70
      },
      "id": 189,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "Summary of node health for the selected session",
        "mode": "markdown"
      },
      "pluginVersion": "11.3.1",
      "title": "",
      "type": "text"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Nodes with multiple conditions may be double counted",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "green",
            "mode": "fixed"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "status"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "0": {
                        "color": "#bf1aef",
                        "index": 2,
                        "text": "UNKNOWN"
                      },
                      "1": {
                        "color": "green",
                        "index": 3,
                        "text": "OK"
                      },
                      "2": {
                        "color": "dark-yellow",
                        "index": 4,
                        "text": "DEGRADED"
                      },
                      "3": {
                        "color": "red",
                        "index": 5,
                        "text": "CRITICAL"
                      },
                      "4": {
                        "color": "#18dbd680",
                        "index": 6,
                        "text": "CRITICAL_EMERGENCY_SHUTDOWN"
                      },
                      "5": {
                        "color": "super-light-blue",
                        "index": 7,
                        "text": "STANDBY"
                      },
                      "6": {
                        "color": "#0d7cea",
                        "index": 8,
                        "text": "PENDING_STANDBY"
                      },
                      "7": {
                        "color": "#12e280",
                        "index": 9,
                        "text": "PENDING_ACTIVE"
                      },
                      "8": {
                        "color": "#dbaa12",
                        "index": 10,
                        "text": "MISSING"
                      },
                      "9": {
                        "color": "#410be3",
                        "index": 11,
                        "text": "NO_POWER"
                      },
                      "10": {
                        "color": "#f1750a",
                        "index": 12,
                        "text": "HARDWARE_ERROR"
                      },
                      "11": {
                        "color": "super-light-orange",
                        "index": 13,
                        "text": "DISABLED"
                      },
                      "12": {
                        "color": "super-light-red",
                        "index": 14,
                        "text": "UNAVAILABLE"
                      },
                      "13": {
                        "color": "#be2b2b",
                        "index": 15,
                        "text": "UPDATING_SW"
                      },
                      "14": {
                        "color": "purple",
                        "index": 16,
                        "text": "PUMP_BLEEDING"
                      },
                      "15": {
                        "color": "blue",
                        "index": 17,
                        "text": "SERVICES_NOT_READY"
                      },
                      "16": {
                        "color": "light-blue",
                        "index": 18,
                        "text": "FPGA_UPDATE"
                      },
                      "17": {
                        "color": "#2eddcf",
                        "index": 19,
                        "text": "PUMP_LIMPING"
                      },
                      "18": {
                        "color": "#8ced0e",
                        "index": 20,
                        "text": "DOOR_OPEN"
                      },
                      "19": {
                        "color": "#0ecef8",
                        "index": 21,
                        "text": "DOOR_CLOSED"
                      },
                      "20": {
                        "index": 22,
                        "text": "NON_STANDARD"
                      },
                      "-1": {
                        "color": "#11469a",
                        "index": 1,
                        "text": "ADMIN_SVC_UNKNOWN"
                      },
                      "-2": {
                        "color": "#ed0a0a",
                        "index": 0,
                        "text": "SYSTEM_NOT_REACHABLE"
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 12,
        "w": 3,
        "x": 0,
        "y": 72
      },
      "id": 183,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count(group by (node) ((kube_node_status_condition{node=~\"$nodes\", condition=~\"ClusterMgmt.*|ClusterDeploy.*|Csadm.*\", condition!~\".*NodeNIC.*\", condition!~\".*NodeSwitchPortError\", status=\"true\"} > 0) )) or vector(0)",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Error"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count (((group by (node,condition) (kube_node_status_condition{node=~\"$nodes\", condition=~\".*Node(NIC|SwitchPort)Error.*\", status=\"true\"} > 0)) or on (node) (group by (node,condition) (label_replace(\n    \n    (node_ipmi_health_status{category=\"Overall\", node=~\"$nodes\"} != 0) and on (node) ((node_ipmi_health_status{category=\"Power supply\", node=~\"$nodes\"} != 0) or on (node) (node_ipmi_health_status{category=\"CPU\", node=~\"$nodes\"} != 0 or node_ipmi_health_status{category=\"Processor\", node=~\"$nodes\"} != 0) or on (node) (node_ipmi_health_status{category=\"Fan\", node=~\"$nodes\"} != 0) or on (node) (node_ipmi_health_status{category=\"Memory\", node=~\"$nodes\"} != 0) or on (node) (node_ipmi_health_status{category=\"Temperatures\", node=~\"$nodes\"} != 0) or on (node) (node_ipmi_health_status{category=\"Storage\", node=~\"$nodes\"} != 0))\n\n\n    , \"condition\", \"IPMIUnhealthy\", \"\", \"\")))  )\n         unless on (node)\n    group by (node) (kube_node_status_condition{node=~\"$nodes\", condition=~\"ClusterMgmt.*|ClusterDeploy.*|Csadm.*\", condition!~\".*NodeNIC.*\", condition!~\".*NodeSwitchPortError\", status=\"true\"} > 0)  )  or vector(0)",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Warning"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count(group by (node) (kube_node_info{node=~\"$nodes\"}))",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Total"
        }
      ],
      "title": "Node status buckets",
      "transformations": [
        {
          "disabled": true,
          "id": "merge",
          "options": {}
        },
        {
          "disabled": true,
          "id": "seriesToRows",
          "options": {}
        },
        {
          "id": "joinByField",
          "options": {}
        },
        {
          "id": "calculateField",
          "options": {
            "alias": "bad",
            "binary": {
              "left": {
                "matcher": {
                  "id": "byName",
                  "options": "Value #Error"
                }
              },
              "right": {
                "matcher": {
                  "id": "byName",
                  "options": "Value #Warning"
                }
              }
            },
            "mode": "binary",
            "reduce": {
              "reducer": "sum"
            }
          }
        },
        {
          "id": "calculateField",
          "options": {
            "alias": "OK",
            "binary": {
              "left": {
                "matcher": {
                  "id": "byName",
                  "options": "Value #Total"
                }
              },
              "operator": "-",
              "right": {
                "matcher": {
                  "id": "byName",
                  "options": "bad"
                }
              }
            },
            "mode": "binary",
            "reduce": {
              "reducer": "sum"
            }
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Value #Total": true,
              "bad": true,
              "condition": true
            },
            "indexByName": {
              "OK": 4,
              "Time": 0,
              "Value #Error": 6,
              "Value #Total": 2,
              "Value #Warning": 5,
              "bad": 3,
              "condition": 1
            },
            "renameByName": {
              "OK": "OK",
              "Value #Error": "Error",
              "Value #Total": "",
              "Value #Warning": "Warning"
            }
          }
        }
      ],
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "green",
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 12,
        "w": 21,
        "x": 3,
        "y": 72
      },
      "id": 185,
      "options": {
        "legend": {
          "calcs": [],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count(stamp_config{node=~\"$nodes\"}) - (count((kube_node_status_condition{node=~\"$nodes\", condition=~\"ClusterMgmt.*|ClusterDeploy.*|Csadm.*\", condition!~\".*NodeNIC.*\", condition!~\".*NodeSwitchPortError\", status=\"true\"} > 0) * on(node) group_left (stamp) stamp_config{node=~\"$nodes\"}) or vector(0)) - (count  (((group by (node,condition) (kube_node_status_condition{node=~\"$nodes\", condition=~\".*Node(NIC|SwitchPort)Error\", status=\"true\"} > 0)) or on (node) (group by (node,condition) (label_replace(((node_ipmi_health_status{category=\"Overall\", node=~\"$nodes\"} != bool 0) > 0) , \"condition\", \"IPMIUnhealthy\", \"\", \"\")))  ) * on(node) group_left (stamp) group by (node, stamp) (stamp_config{node=~\"$nodes\"})))",
          "format": "time_series",
          "hide": false,
          "instant": false,
          "legendFormat": "OK",
          "range": true,
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count(group by (node) ((kube_node_status_condition{node=~\"$nodes\", condition=~\"ClusterMgmt.*|ClusterDeploy.*|Csadm.*\", condition!~\".*NodeNIC.*\", condition!~\".*NodeSwitchPortError\", status=\"true\"} > 0) * on(node) group_left (stamp) group by (node,stamp) (stamp_config{node=~\"$nodes\"}))) or vector(0)",
          "format": "time_series",
          "hide": false,
          "instant": false,
          "legendFormat": "Error",
          "range": true,
          "refId": "C"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "expr": "count  (((group by (node,condition) (kube_node_status_condition{node=~\"$nodes\", condition=~\".*Node(NIC|SwitchPort)Error\", status=\"true\"} > 0)) or on (node) (group by (node,condition) (label_replace(((node_ipmi_health_status{category=\"Overall\", node=~\"$nodes\"} != bool 0) > 0) , \"condition\", \"IPMIUnhealthy\", \"\", \"\")))  ) * on(node) group_left (stamp) group by (node, stamp) (stamp_config{node=~\"$nodes\"}))\n",
          "hide": false,
          "instant": false,
          "legendFormat": "Warning",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Node status over time",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 84
      },
      "id": 63,
      "panels": [],
      "title": "Selected Session - Switches - Overview",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 85
      },
      "id": 190,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "Status of switch stat collection services",
        "mode": "markdown"
      },
      "pluginVersion": "11.3.1",
      "title": "",
      "type": "text"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Up if at least one switch is returning SNMP results and at least one SNMP query is recorded in the database",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [
            {
              "options": {
                "0": {
                  "color": "red",
                  "index": 0,
                  "text": "Down"
                },
                "1": {
                  "index": 1,
                  "text": "Up"
                }
              },
              "type": "value"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 0,
        "y": 87
      },
      "id": 64,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "expr": "(scalar(count(up{job=\"snmp\"}>0)) * scalar(count(ifOperStatus))) >bool 0",
          "instant": false,
          "legendFormat": "SNMP",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "expr": "(scalar(up{container=\"cluster-mgmt-linkmon-switch\"}) * scalar(count(linkmon_switch_oper_status))) >bool 0",
          "hide": false,
          "instant": false,
          "legendFormat": "Linkmon (CLI)",
          "range": true,
          "refId": "B"
        }
      ],
      "title": "Monitoring Status",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Number of switches currently responding to SNMP queries and number of switches listed in network_config.json",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "green",
            "mode": "fixed"
          },
          "mappings": [],
          "thresholds": {
            "mode": "percentage",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              },
              {
                "color": "#EAB839",
                "value": 90
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 4,
        "y": 87
      },
      "id": 65,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count(up{job=\"snmp\", switch_id=~\"$switches\"}>0)",
          "instant": true,
          "legendFormat": "Scraped",
          "range": false,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count(up{job=\"snmp\", switch_id=~\"$switches\"})",
          "hide": false,
          "instant": true,
          "legendFormat": "In watch list",
          "range": false,
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "expr": "count(stamp_config{switch=~\"$switches\"})",
          "hide": false,
          "instant": false,
          "legendFormat": "In this session",
          "range": true,
          "refId": "C"
        }
      ],
      "title": "SNMP Switch Monitor Count",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Oldest and newest timestamp of the latest available switch response to a standard query",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          },
          "unit": "dateTimeFromNow"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 10,
        "y": 87
      },
      "id": 69,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "text": {},
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "1000*max(timestamp(ifOperStatus{switch_id=~\"$switches\"}))",
          "instant": true,
          "legendFormat": "Newest",
          "range": false,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "min(timestamp(ifOperStatus{switch_id=~\"$switches\"}))*1000",
          "hide": false,
          "instant": true,
          "legendFormat": "Oldest",
          "range": false,
          "refId": "B"
        }
      ],
      "title": "SNMP Switch - Data Timestamps",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Number of switches currently responding to linkmon queries and number of switches listed in network_config.json",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "percentage",
            "steps": [
              {
                "color": "green"
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 14,
        "y": 87
      },
      "id": 68,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count(group by (switch) (linkmon_switch_oper_status{switch=~\"$switches\"}))",
          "instant": true,
          "legendFormat": "Scraped",
          "range": false,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count(group by (switch_id) (interface_watch_list{switch_id=~\"$switches\"}))",
          "hide": false,
          "instant": true,
          "legendFormat": "In watch list",
          "range": false,
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "expr": "count(stamp_config{switch=~\"$switches\"})",
          "hide": false,
          "instant": false,
          "legendFormat": "In this session",
          "range": true,
          "refId": "C"
        }
      ],
      "title": "Linkmon Switch Monitor Count",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Oldest and newest timestamp of the latest available switch response to a standard query",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          },
          "unit": "dateTimeFromNow"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 20,
        "y": 87
      },
      "id": 66,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "text": {},
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "1000*max(timestamp(linkmon_switch_oper_status{switch=~\"$switches\"}))",
          "instant": true,
          "legendFormat": "Newest",
          "range": false,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "min(timestamp(linkmon_switch_oper_status{switch=~\"$switches\"}))*1000",
          "hide": false,
          "instant": true,
          "legendFormat": "Oldest",
          "range": false,
          "refId": "B"
        }
      ],
      "title": "Linkmon Switch - Data Timestamps",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 91
      },
      "id": 144,
      "panels": [],
      "title": "Selected Session - Systems - Action Required",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 92
      },
      "id": 191,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "Systems requiring attention due to being in an error or down state or having failing links",
        "mode": "markdown"
      },
      "pluginVersion": "11.3.1",
      "title": "",
      "type": "text"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "System Health DB",
              "url": "d/df3huubwl3hfkd-internal/system-health-details?from=${__from}&to=${__to}&var-system=${__data.fields.system}"
            }
          ],
          "mappings": [],
          "noValue": "All Systems OK",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "0": {
                        "color": "#bf1aef",
                        "index": 2,
                        "text": "UNKNOWN"
                      },
                      "1": {
                        "color": "green",
                        "index": 3,
                        "text": "OK"
                      },
                      "2": {
                        "color": "dark-yellow",
                        "index": 4,
                        "text": "DEGRADED"
                      },
                      "3": {
                        "color": "red",
                        "index": 5,
                        "text": "CRITICAL"
                      },
                      "4": {
                        "color": "#18dbd680",
                        "index": 6,
                        "text": "CRITICAL_EMERGENCY_SHUTDOWN"
                      },
                      "5": {
                        "color": "super-light-blue",
                        "index": 7,
                        "text": "STANDBY"
                      },
                      "6": {
                        "color": "#0d7cea",
                        "index": 8,
                        "text": "PENDING_STANDBY"
                      },
                      "7": {
                        "color": "#12e280",
                        "index": 9,
                        "text": "PENDING_ACTIVE"
                      },
                      "8": {
                        "color": "#dbaa12",
                        "index": 10,
                        "text": "MISSING"
                      },
                      "9": {
                        "color": "#410be3",
                        "index": 11,
                        "text": "NO_POWER"
                      },
                      "10": {
                        "color": "#f1750a",
                        "index": 12,
                        "text": "HARDWARE_ERROR"
                      },
                      "11": {
                        "color": "super-light-orange",
                        "index": 13,
                        "text": "DISABLED"
                      },
                      "12": {
                        "color": "super-light-red",
                        "index": 14,
                        "text": "UNAVAILABLE"
                      },
                      "13": {
                        "color": "#be2b2b",
                        "index": 15,
                        "text": "UPDATING_SW"
                      },
                      "14": {
                        "color": "purple",
                        "index": 16,
                        "text": "PUMP_BLEEDING"
                      },
                      "15": {
                        "color": "blue",
                        "index": 17,
                        "text": "SERVICES_NOT_READY"
                      },
                      "16": {
                        "color": "light-blue",
                        "index": 18,
                        "text": "FPGA_UPDATE"
                      },
                      "17": {
                        "color": "#2eddcf",
                        "index": 19,
                        "text": "PUMP_LIMPING"
                      },
                      "18": {
                        "color": "#8ced0e",
                        "index": 20,
                        "text": "DOOR_OPEN"
                      },
                      "19": {
                        "color": "#0ecef8",
                        "index": 21,
                        "text": "DOOR_CLOSED"
                      },
                      "20": {
                        "index": 22,
                        "text": "NON_STANDARD"
                      },
                      "-1": {
                        "color": "#11469a",
                        "index": 1,
                        "text": "ADMIN_SVC_UNKNOWN"
                      },
                      "-2": {
                        "color": "#ed0a0a",
                        "index": 0,
                        "text": "SYSTEM_NOT_REACHABLE"
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 8,
        "x": 0,
        "y": 94
      },
      "id": 98,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "flaps"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "(system_overall_health{system=~\"$systems\"} != 1) and (system_overall_health{system=~\"$systems\"} != 2)",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "sum by (system) (increase(system_network_flap_count{system=~\"$systems\"}[$__range]) > 2)",
          "format": "table",
          "hide": true,
          "instant": true,
          "legendFormat": "flaps",
          "range": false,
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "changes(system_overall_health{system=~\"$systems\"}[$__range]) > 0",
          "format": "table",
          "hide": true,
          "instant": true,
          "legendFormat": "heath state changes",
          "range": false,
          "refId": "C"
        }
      ],
      "title": "Unusable systems",
      "transformations": [
        {
          "disabled": true,
          "id": "joinByField",
          "options": {
            "byField": "system",
            "mode": "outer"
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "__name__": true,
              "instance": true,
              "instance 2": true,
              "job": true,
              "job 2": true,
              "namespace": true,
              "namespace 2": true,
              "prometheus": true,
              "prometheus 2": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value #A": "current health",
              "Value #B": "flaps",
              "Value #C": "health state changes"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "System Health DB",
              "url": "d/df3huubwl3hfkd-internal/system-health-details?from=${__from}&to=${__to}&var-system=${__data.fields.system}"
            }
          ],
          "mappings": [],
          "noValue": "All Systems OK",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "0": {
                        "color": "#bf1aef",
                        "index": 2,
                        "text": "UNKNOWN"
                      },
                      "1": {
                        "color": "green",
                        "index": 3,
                        "text": "OK"
                      },
                      "2": {
                        "color": "dark-yellow",
                        "index": 4,
                        "text": "DEGRADED"
                      },
                      "3": {
                        "color": "red",
                        "index": 5,
                        "text": "CRITICAL"
                      },
                      "4": {
                        "color": "#18dbd680",
                        "index": 6,
                        "text": "CRITICAL_EMERGENCY_SHUTDOWN"
                      },
                      "5": {
                        "color": "super-light-blue",
                        "index": 7,
                        "text": "STANDBY"
                      },
                      "6": {
                        "color": "#0d7cea",
                        "index": 8,
                        "text": "PENDING_STANDBY"
                      },
                      "7": {
                        "color": "#12e280",
                        "index": 9,
                        "text": "PENDING_ACTIVE"
                      },
                      "8": {
                        "color": "#dbaa12",
                        "index": 10,
                        "text": "MISSING"
                      },
                      "9": {
                        "color": "#410be3",
                        "index": 11,
                        "text": "NO_POWER"
                      },
                      "10": {
                        "color": "#f1750a",
                        "index": 12,
                        "text": "HARDWARE_ERROR"
                      },
                      "11": {
                        "color": "super-light-orange",
                        "index": 13,
                        "text": "DISABLED"
                      },
                      "12": {
                        "color": "super-light-red",
                        "index": 14,
                        "text": "UNAVAILABLE"
                      },
                      "13": {
                        "color": "#be2b2b",
                        "index": 15,
                        "text": "UPDATING_SW"
                      },
                      "14": {
                        "color": "purple",
                        "index": 16,
                        "text": "PUMP_BLEEDING"
                      },
                      "15": {
                        "color": "blue",
                        "index": 17,
                        "text": "SERVICES_NOT_READY"
                      },
                      "16": {
                        "color": "light-blue",
                        "index": 18,
                        "text": "FPGA_UPDATE"
                      },
                      "17": {
                        "color": "#2eddcf",
                        "index": 19,
                        "text": "PUMP_LIMPING"
                      },
                      "18": {
                        "color": "#8ced0e",
                        "index": 20,
                        "text": "DOOR_OPEN"
                      },
                      "19": {
                        "color": "#0ecef8",
                        "index": 21,
                        "text": "DOOR_CLOSED"
                      },
                      "20": {
                        "index": 22,
                        "text": "NON_STANDARD"
                      },
                      "-1": {
                        "color": "#11469a",
                        "index": 1,
                        "text": "ADMIN_SVC_UNKNOWN"
                      },
                      "-2": {
                        "color": "#ed0a0a",
                        "index": 0,
                        "text": "SYSTEM_NOT_REACHABLE"
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 4,
        "x": 8,
        "y": 94
      },
      "id": 210,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "flaps"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "(system_status_condition{type=\"CsadmSystemError\", system=~\"$systems\"} > 0) unless on (system) ((system_overall_health{system=~\"$systems\"} != 1) and (system_overall_health{system=~\"$systems\"} != 2))",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Systems marked as error by csadm",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "Value": true,
              "__name__": true,
              "container": true,
              "customresource_group": true,
              "customresource_kind": true,
              "customresource_version": true,
              "endpoint": true,
              "instance": true,
              "instance 2": true,
              "job": true,
              "job 2": true,
              "namespace": true,
              "namespace 2": true,
              "pod": true,
              "prometheus": true,
              "prometheus 2": true,
              "service": true,
              "type": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value #A": "current health",
              "Value #B": "flaps",
              "Value #C": "health state changes"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/cehh15ni8ip6oa-internal/system-port-details?from=${__from}&to=${__to}&var-system=${__data.fields.system}&var-port=${__data.fields.port}"
            }
          ],
          "mappings": [],
          "noValue": "All ports up",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "port"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 63
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "system"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 182
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 5,
        "x": 12,
        "y": 94
      },
      "id": 148,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Flaps"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "(system_network_health == 0) * on (system) group_left (instance) (system_overall_health{system=~\"$systems\"} == 1 or system_overall_health{system=~\"$systems\"} == 2)",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "down",
          "range": false,
          "refId": "B"
        }
      ],
      "title": "Down Ports",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "Time 4": true,
              "Value": true,
              "__name__": true,
              "instance": true,
              "instance 2": true,
              "job": true,
              "job 2": true,
              "namespace": true,
              "namespace 2": true,
              "prometheus": true,
              "prometheus 2": true
            },
            "includeByName": {},
            "indexByName": {
              "Time 1": 1,
              "Time 2": 8,
              "Time 3": 11,
              "Time 4": 17,
              "Value #A": 7,
              "Value #B": 9,
              "Value #C": 16,
              "Value #D": 10,
              "__name__": 2,
              "instance 1": 3,
              "instance 2": 12,
              "job 1": 4,
              "job 2": 13,
              "namespace 1": 5,
              "namespace 2": 14,
              "prometheus 1": 6,
              "prometheus 2": 15,
              "system": 0
            },
            "renameByName": {
              "Value": "Flaps",
              "Value #A": "current health",
              "Value #B": "flaps",
              "Value #C": "health state changes",
              "Value #D": "old flap calc"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/cehh15ni8ip6oa-internal/system-port-details?from=${__from}&to=${__to}&var-system=${__data.fields.system}&var-port=${__data.fields.port}"
            }
          ],
          "mappings": [],
          "noValue": "No flapping ports during selected time range",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "port"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 63
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "system"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 182
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 7,
        "x": 17,
        "y": 94
      },
      "id": 129,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Flaps"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "sum by (system, port) (sum_over_time((idelta(system_network_flap_count{system=~\"$systems\"}[3m]) * on (system) group_left () group by (system) ((system_overall_health{system=~\"$systems\"} == 1 or (system_overall_health{system=~\"$systems\"} == 2)-1)))[$__range:])) > 0",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "flaps during query range",
          "range": false,
          "refId": "B"
        }
      ],
      "title": "Flapping Ports over time range",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "Time 4": true,
              "__name__": true,
              "instance": true,
              "instance 2": true,
              "job": true,
              "job 2": true,
              "namespace": true,
              "namespace 2": true,
              "prometheus": true,
              "prometheus 2": true
            },
            "includeByName": {},
            "indexByName": {
              "Time 1": 1,
              "Time 2": 8,
              "Time 3": 11,
              "Time 4": 17,
              "Value #A": 7,
              "Value #B": 9,
              "Value #C": 16,
              "Value #D": 10,
              "__name__": 2,
              "instance 1": 3,
              "instance 2": 12,
              "job 1": 4,
              "job 2": 13,
              "namespace 1": 5,
              "namespace 2": 14,
              "prometheus 1": 6,
              "prometheus 2": 15,
              "system": 0
            },
            "renameByName": {
              "Value": "Flaps",
              "Value #A": "current health",
              "Value #B": "flaps",
              "Value #C": "health state changes",
              "Value #D": "old flap calc"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Ports that aren't responding to pings (using CPingmesh).",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/cehh15ni8ip6oa-internal/system-port-details?from=${__from}&to=${__to}&var-system=${__data.fields.host}&var-port=${__data.fields.nic}"
            }
          ],
          "mappings": [],
          "noValue": "All ports reachable",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "port"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 63
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "system"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 182
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Port"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 104
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 5,
        "x": 12,
        "y": 108
      },
      "id": 218,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "group by (host, nic) (pingmesh:unreachable5m{host=~\"$systems\"})",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "down",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Unreachable Ports",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "host": "System",
              "nic": "Port"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 122
      },
      "id": 150,
      "panels": [],
      "title": "Selected Session - Nodes - Action Required",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 109
      },
      "id": 192,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "Nodes requiring attention due to being in an error or down state or having failing links, or critical overheat conditions, or other hardware problems",
        "mode": "markdown"
      },
      "pluginVersion": "11.3.1",
      "title": "",
      "type": "text"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Unreachable, kubelet not running, or marked down by administrator",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Node Health Details",
              "url": "d/eehh0zde6wo3ka-internal/node-health-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}"
            }
          ],
          "mappings": [
            {
              "options": {
                "0": {
                  "index": 0,
                  "text": "kubelet down"
                },
                "1": {
                  "index": 1,
                  "text": "unreachable"
                }
              },
              "type": "value"
            }
          ],
          "noValue": "All nodes up",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 14,
        "w": 4,
        "x": 0,
        "y": 111
      },
      "id": 151,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": false,
            "displayName": "node"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "group by (node) ((kube_node_status_condition{node=~\"$nodes\", condition=~\"ClusterMgmt.*|ClusterDeploy.*|Csadm.*\", condition!~\".*NodeNIC.*\", condition!~\".*NodeSwitchPortError\", status=\"true\"} > 0) or on (node) kube_node_spec_taint{job=\"kube-state-metrics\",key=\"node.kubernetes.io/unreachable\",effect=\"NoSchedule\", node=~\"$nodes\"} == 1)",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "{{node}}",
          "range": false,
          "refId": "C"
        }
      ],
      "title": "Down",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": true,
              "__name__": true,
              "condition": true,
              "container": true,
              "endpoint": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "node": false,
              "pod": true,
              "prometheus": true,
              "service": true,
              "stamp": true,
              "status": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {}
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/aehh1fckgpjpca-internal/node-port-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}&var-interface=${__data.fields.device}"
            }
          ],
          "mappings": [],
          "noValue": "All ports up",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "port"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 63
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "system"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 182
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 4,
        "x": 4,
        "y": 111
      },
      "id": 152,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Flaps"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "(interface_watch_list:status{node=~\"$nodes\"} == 0) unless on (node) group by (node) ((kube_node_status_condition{node=~\"$nodes\", condition=~\"ClusterMgmt.*|ClusterDeploy.*|Csadm.*\", condition!~\".*NodeNIC.*\", condition!~\".*NodeSwitchPortError\", status=\"true\"} > 0) or on (node) kube_node_spec_taint{job=\"kube-state-metrics\",key=\"node.kubernetes.io/unreachable\",effect=\"NoSchedule\", node=~\"$nodes\"} == 1)",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "down",
          "range": false,
          "refId": "B"
        }
      ],
      "title": "Down Ports",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "Time 4": true,
              "Value": true,
              "__name__": true,
              "instance": true,
              "instance 2": true,
              "job": true,
              "job 2": true,
              "namespace": true,
              "namespace 2": true,
              "prometheus": true,
              "prometheus 2": true,
              "thanos_ruler_replica": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 1,
              "Value": 6,
              "__name__": 0,
              "device": 3,
              "instance": 4,
              "node": 2,
              "thanos_ruler_replica": 5
            },
            "renameByName": {
              "Value": "Flaps",
              "Value #A": "current health",
              "Value #B": "flaps",
              "Value #C": "health state changes",
              "Value #D": "old flap calc"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/aehh1fckgpjpca-internal/node-port-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}&var-interface=${__data.fields.device}"
            }
          ],
          "mappings": [],
          "noValue": "No flapping ports during selected time range",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "port"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 63
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "system"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 182
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "device"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 124
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 6,
        "x": 8,
        "y": 111
      },
      "id": 154,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Flaps"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "(increase(interface_watch_list:status_changes_total{node=~\"$nodes\"}[$__range] ) > 2) unless on (node) group by (node) ((kube_node_status_condition{node=~\"$nodes\", condition=~\"ClusterMgmt.*|ClusterDeploy.*|Csadm.*\", condition!~\".*NodeNIC.*\", condition!~\".*NodeSwitchPortError\", status=\"true\"} > 0) or on (node) kube_node_spec_taint{job=\"kube-state-metrics\",key=\"node.kubernetes.io/unreachable\",effect=\"NoSchedule\", node=~\"$nodes\"} == 1)",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "down",
          "range": false,
          "refId": "B"
        }
      ],
      "title": "Flapping Ports",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "Time 4": true,
              "Value": false,
              "__name__": true,
              "instance": true,
              "instance 2": true,
              "job": true,
              "job 2": true,
              "namespace": true,
              "namespace 2": true,
              "prometheus": true,
              "prometheus 2": true,
              "thanos_ruler_replica": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 1,
              "Value": 6,
              "__name__": 0,
              "device": 3,
              "instance": 4,
              "node": 2,
              "thanos_ruler_replica": 5
            },
            "renameByName": {
              "Value": "Flaps",
              "Value #A": "current health",
              "Value #B": "flaps",
              "Value #C": "health state changes",
              "Value #D": "old flap calc"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Node Health",
              "url": "d/eehh0zde6wo3ka-internal/node-health-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}"
            }
          ],
          "mappings": [
            {
              "options": {
                "1": {
                  "index": 1,
                  "text": "Warning"
                },
                "2": {
                  "index": 0,
                  "text": "Error"
                }
              },
              "type": "value"
            }
          ],
          "noValue": "No IPMI error conditions",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "CPU"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 56
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Fan"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 62
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Memory"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 88
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Thermal"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 74
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Power Supply"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 109
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "node"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 309
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Storage"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 83
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 10,
        "x": 14,
        "y": 111
      },
      "id": 157,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 5,
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"CPU\", node=~\"$nodes\"} == 2 or node_ipmi_health_status{category=\"Processor\", node=~\"$nodes\"} == 2",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "CPU"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Fan\", node=~\"$nodes\"}  == 2",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Fan"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Memory\", node=~\"$nodes\"}  == 2",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Memory"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Temperatures\", node=~\"$nodes\"}  == 2",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Thermal"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Power supply\", node=~\"$nodes\"}  == 2",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "PSU"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Overall\", node=~\"$nodes\"} == 2",
          "format": "table",
          "hide": true,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Overall"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Storage\", node=~\"$nodes\"}  == 2",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Storage"
        }
      ],
      "title": "IPMI",
      "transformations": [
        {
          "id": "seriesToRows",
          "options": {}
        },
        {
          "disabled": true,
          "id": "merge",
          "options": {}
        },
        {
          "id": "joinByField",
          "options": {
            "byField": "node",
            "mode": "outer"
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "Time 4": true,
              "Time 5": true,
              "Value #Overall": false,
              "__name__": true,
              "__name__ 1": true,
              "__name__ 2": true,
              "__name__ 3": true,
              "__name__ 4": true,
              "__name__ 5": true,
              "category": true,
              "category 1": true,
              "category 2": true,
              "category 3": true,
              "instance": true,
              "instance 1": true,
              "instance 2": true,
              "instance 3": true,
              "instance 4": true,
              "instance 5": true,
              "job": true,
              "job 1": true,
              "job 2": true,
              "job 3": true,
              "job 4": true,
              "job 5": true,
              "namespace": true,
              "namespace 1": true,
              "namespace 2": true,
              "namespace 3": true,
              "namespace 4": true,
              "namespace 5": true,
              "prometheus": true,
              "prometheus 1": true,
              "prometheus 2": true,
              "prometheus 3": true,
              "prometheus 4": true,
              "prometheus 5": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value #Fan": 7,
              "Value #Memory": 8,
              "Value #Overall": 11,
              "Value #PSU": 9,
              "Value #Storage": 10,
              "__name__": 2,
              "instance": 3,
              "job": 4,
              "namespace": 5,
              "node": 1,
              "prometheus": 6
            },
            "renameByName": {
              "Value #A": "CPU",
              "Value #B": "Fan",
              "Value #C": "Memory",
              "Value #CPU": "CPU",
              "Value #D": "Thermal",
              "Value #E": "Power Supply",
              "Value #Fan": "Fan",
              "Value #Memory": "Memory",
              "Value #Overall": "Overall",
              "Value #PSU": "Power Supply",
              "Value #Storage": "Storage",
              "Value #Thermal": "Thermal"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Node Health",
              "url": "d/eehh0zde6wo3ka-internal/node-health-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}"
            }
          ],
          "mappings": [],
          "noValue": "No events",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "celsius"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 14,
        "w": 8,
        "x": 0,
        "y": 125
      },
      "id": 156,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Temp"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_thermals_thermometer{health!=\"1\", node=~\"$nodes\"} > 0",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "{{node}}",
          "range": false,
          "refId": "B"
        }
      ],
      "title": "Overheat conditions - IPMI Sensors",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "Time 4": true,
              "__name__": true,
              "container": true,
              "endpoint": true,
              "health": true,
              "index": true,
              "instance": true,
              "instance 2": true,
              "job": true,
              "job 2": true,
              "namespace": true,
              "namespace 2": true,
              "pod": true,
              "prometheus": true,
              "prometheus 2": true,
              "thanos_ruler_replica": true,
              "units": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 5,
              "__name__": 3,
              "description": 4,
              "health": 9,
              "index": 10,
              "instance": 2,
              "job": 6,
              "namespace": 7,
              "node": 1,
              "prometheus": 8,
              "units": 11
            },
            "renameByName": {
              "Value": "Temp",
              "Value #A": "current health",
              "Value #B": "flaps",
              "Value #C": "health state changes",
              "Value #D": "old flap calc"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "d/aehh1fckgpjpca-internal/node-port-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}&var-interface=${__data.fields.interface}"
            }
          ],
          "mappings": [],
          "noValue": "No events",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "celsius"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "port"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 63
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "system"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 182
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 7,
        "x": 8,
        "y": 125
      },
      "id": 153,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Temp"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_nic_stats_temperature{node=~\"$nodes\"} >= 95",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "{{node}}",
          "range": false,
          "refId": "B"
        }
      ],
      "title": "Overheat conditions - NIC ASIC",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "Time 4": true,
              "__name__": true,
              "container": true,
              "endpoint": true,
              "instance": true,
              "instance 2": true,
              "job": true,
              "job 2": true,
              "namespace": true,
              "namespace 2": true,
              "pod": true,
              "prometheus": true,
              "prometheus 2": true,
              "thanos_ruler_replica": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 7,
              "__name__": 3,
              "container": 4,
              "endpoint": 5,
              "instance": 2,
              "interface": 6,
              "job": 8,
              "namespace": 9,
              "node": 1,
              "pod": 10,
              "prometheus": 11
            },
            "renameByName": {
              "Value": "Temp",
              "Value #A": "current health",
              "Value #B": "flaps",
              "Value #C": "health state changes",
              "Value #D": "old flap calc"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "d/aehh1fckgpjpca-internal/node-port-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}&var-interface=${__data.fields.interface}"
            }
          ],
          "mappings": [],
          "noValue": "No events",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "celsius"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "port"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 63
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "system"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 182
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 5,
        "x": 15,
        "y": 125
      },
      "id": 155,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Flaps"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_nic_stats_opt_temperature{node=~\"$nodes\"} * node_nic_stats_opt_temperature_alarm{node=~\"$nodes\"} > 0",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "{{node}}",
          "range": false,
          "refId": "B"
        }
      ],
      "title": "Overheat conditions - NIC Optics",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "Time 4": true,
              "__name__": true,
              "container": true,
              "endpoint": true,
              "instance": true,
              "instance 2": true,
              "job": true,
              "job 2": true,
              "namespace": true,
              "namespace 2": true,
              "pod": true,
              "prometheus": true,
              "prometheus 2": true,
              "thanos_ruler_replica": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 7,
              "__name__": 3,
              "container": 4,
              "endpoint": 5,
              "instance": 2,
              "interface": 6,
              "job": 8,
              "namespace": 9,
              "node": 1,
              "pod": 10,
              "prometheus": 11
            },
            "renameByName": {
              "Value": "Temp",
              "Value #A": "current health",
              "Value #B": "flaps",
              "Value #C": "health state changes",
              "Value #D": "old flap calc"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Interfaces that aren't responding to pings (using CPingmesh).",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details: ${__data.fields.host} ${__data.fields.nic}",
              "url": "/d/aehh1fckgpjpca-internal/node-port-details?from=${__from}&to=${__to}&var-node=${__data.fields.host}&var-interface=${__data.fields.nic}"
            }
          ],
          "mappings": [],
          "noValue": "All ports reachable",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "port"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 63
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "system"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 182
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 14,
        "w": 4,
        "x": 20,
        "y": 139
      },
      "id": 217,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Flaps"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "group by (host, nic) (pingmesh:unreachable5m{host=~\"$nodes\"})",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "down",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Unreachable Ports",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "host": "Node",
              "nic": "Device"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 153
      },
      "id": 36,
      "panels": [],
      "title": "Selected Session - Switches - Action Required",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 140
      },
      "id": 193,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "Switches requiring attention due to failing links",
        "mode": "markdown"
      },
      "pluginVersion": "11.3.1",
      "title": "",
      "type": "text"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Time and duration of port issues (port is down or had one or more flaps) - only for explicitly tracked ports from the network_config.json",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/dehh10cie0o3ka-internal/switch-port-details?from=${__from}&to=${__to}&var-switch=${__data.fields.switch_id}&var-port=${__data.fields.ifName}"
            }
          ],
          "mappings": [],
          "noValue": "All ports up",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Status"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "0": {
                        "index": 5,
                        "text": "Down"
                      },
                      "1": {
                        "index": 0,
                        "text": "Down"
                      },
                      "2": {
                        "index": 2,
                        "text": "Down"
                      },
                      "6": {
                        "index": 4,
                        "text": "NotPresent"
                      },
                      "7": {
                        "index": 3,
                        "text": "Down"
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "match": "null",
                      "result": {
                        "index": 1,
                        "text": "Up"
                      }
                    },
                    "type": "special"
                  }
                ]
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Flaps"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "match": "null",
                      "result": {
                        "index": 1,
                        "text": "0"
                      }
                    },
                    "type": "special"
                  }
                ]
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 12,
        "w": 11,
        "x": 0,
        "y": 142
      },
      "id": 138,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 0,
        "showHeader": true,
        "sortBy": [
          {
            "desc": false,
            "displayName": "switch_id"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "(((ifOperStatus{switch_id=~\"$switches\"})!=1) or on (switch_id, ifName)( (label_replace(label_replace((((linkmon_switch_oper_status{switch=~\"$switches\"}) != 1)) , \"ifName\", \"$1\", \"port\", \"(.*)\"), \"switch_id\", \"$1\", \"switch\", \"(.*)\")))) * on (ifName, switch_id) group_left (conn_type, node, device) (interface_watch_list{node=\"$nodes|$systems|$switches\"} unless on (node) (kube_node_status_condition{condition=\"Ready\",status=\"true\", node=~\"$nodes\"} == 0 or on (node) kube_node_spec_taint{job=\"kube-state-metrics\",key=\"node.kubernetes.io/unreachable\",effect=\"NoSchedule\", node=~\"$nodes\"} == 1 or on (node) (label_replace((system_overall_health{system=~\"$systems\"} != 1 and system_overall_health{system=~\"$systems\"} != 2), \"node\", \"$1\", \"system\", \"(.*)\"))))",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "down ports",
          "range": false,
          "refId": "B"
        }
      ],
      "title": "Down Ports",
      "transformations": [
        {
          "disabled": true,
          "id": "merge",
          "options": {}
        },
        {
          "disabled": true,
          "id": "calculateField",
          "options": {
            "alias": "swid_ifname",
            "binary": {
              "left": "switch_id",
              "right": "ifName"
            },
            "mode": "binary",
            "reduce": {
              "reducer": "sum"
            }
          }
        },
        {
          "disabled": true,
          "id": "joinByField",
          "options": {
            "byField": "swid_ifname",
            "mode": "outer"
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Value": true,
              "Value #C": true,
              "container": true,
              "desc": true,
              "endpoint": true,
              "ifIndex": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "pod": true,
              "port": true,
              "prometheus": true,
              "snmp_exporter_host": true,
              "swid_ifname": true,
              "switch": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value #B": 6,
              "Value #C": 7,
              "conn_type": 3,
              "device": 5,
              "ifName": 2,
              "node": 4,
              "swid_ifname": 8,
              "switch_id": 1
            },
            "renameByName": {
              "Value #B": "Status",
              "Value #C": "Flaps",
              "conn_type": "Link Type",
              "device": "remote port",
              "node": "remote device"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Time and duration of port issues (port is down or had one or more flaps) - only for explicitly tracked ports from the network_config.json",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/dehh10cie0o3ka-internal/switch-port-details?from=${__from}&to=${__to}&var-switch=${__data.fields.switch_id}&var-port=${__data.fields.ifName}"
            }
          ],
          "mappings": [],
          "noValue": "No flapping ports during selected time range",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Status"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "0": {
                        "index": 5,
                        "text": "Down"
                      },
                      "1": {
                        "index": 0,
                        "text": "Down"
                      },
                      "2": {
                        "index": 2,
                        "text": "Down"
                      },
                      "6": {
                        "index": 4,
                        "text": "NotPresent"
                      },
                      "7": {
                        "index": 3,
                        "text": "Down"
                      }
                    },
                    "type": "value"
                  },
                  {
                    "options": {
                      "match": "null",
                      "result": {
                        "index": 1,
                        "text": "Up"
                      }
                    },
                    "type": "special"
                  }
                ]
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Flaps"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "match": "null",
                      "result": {
                        "index": 1,
                        "text": "0"
                      }
                    },
                    "type": "special"
                  }
                ]
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 12,
        "w": 13,
        "x": 11,
        "y": 142
      },
      "id": 173,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 0,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Flaps"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "(( (changes(ifLastChange{switch_id=~\"$switches\"}[$__range])>0) ) or on (switch_id, ifName)(  (label_replace(label_replace(((changes(linkmon_switch_carrier_changes{switch=~\"$switches\"}[$__range]) > 0) ) , \"ifName\", \"$1\", \"port\", \"(.*)\"), \"switch_id\", \"$1\", \"switch\", \"(.*)\")))) * on (ifName, switch_id) group_left (conn_type, node, device) (interface_watch_list{node=~\"$nodes|$systems|$switches\"} unless on (node) (kube_node_status_condition{condition=\"Ready\",status=\"true\", node=~\"$nodes\"} == 0 or on (node) kube_node_spec_taint{job=\"kube-state-metrics\",key=\"node.kubernetes.io/unreachable\",effect=\"NoSchedule\", node=~\"$nodes\"} == 1 or on (node) (label_replace((system_overall_health{system=~\"$systems\"} != 1 and system_overall_health{system=~\"$systems\"} != 2), \"node\", \"$1\", \"system\", \"(.*)\"))))",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "flapping ports",
          "range": false,
          "refId": "C"
        }
      ],
      "title": "Flapping Ports",
      "transformations": [
        {
          "disabled": true,
          "id": "merge",
          "options": {}
        },
        {
          "disabled": true,
          "id": "calculateField",
          "options": {
            "alias": "swid_ifname",
            "binary": {
              "left": "switch_id",
              "right": "ifName"
            },
            "mode": "binary",
            "reduce": {
              "reducer": "sum"
            }
          }
        },
        {
          "disabled": true,
          "id": "joinByField",
          "options": {
            "byField": "swid_ifname",
            "mode": "outer"
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "container": true,
              "desc": true,
              "endpoint": true,
              "ifIndex": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "pod": true,
              "port": true,
              "prometheus": true,
              "snmp_exporter_host": true,
              "swid_ifname": true,
              "switch": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value #B": 6,
              "Value #C": 7,
              "conn_type": 3,
              "device": 5,
              "ifName": 2,
              "node": 4,
              "swid_ifname": 8,
              "switch_id": 1
            },
            "renameByName": {
              "Value": "Flaps",
              "Value #B": "Status",
              "Value #C": "Flaps",
              "conn_type": "Link Type",
              "device": "remote port",
              "node": "remote device"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/dehh10cie0o3ka-internal/switch-port-details?from=${__from}&to=${__to}&var-switch=${__data.fields.switch_id}&var-port=${__data.fields.ifName}"
            }
          ],
          "mappings": [],
          "noValue": "No optics overtemp errors",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "celsius"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "conn_type"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 117
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 9,
        "w": 17,
        "x": 0,
        "y": 154
      },
      "id": 140,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Temperature"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "label_replace(label_replace(linkmon_switch_opt_temperature{switch=~\"$switches\"} > 0 , \"ifName\", \"$1\", \"port\", \"(.*)\"), \"switch_id\", \"$1\", \"switch\", \"(.*)\") * on (ifName, switch_id) group_left (conn_type, node, device) interface_watch_list{switch_id=~\".*\", node=~\"$nodes|$switches|$systems\"} > 80",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "avg",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Optics over error threshold temp",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "container": true,
              "desc": true,
              "endpoint": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "pod": true,
              "port": true,
              "prometheus": true,
              "switch": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 16,
              "conn_type": 3,
              "container": 4,
              "desc": 7,
              "device": 6,
              "endpoint": 8,
              "ifName": 2,
              "instance": 9,
              "job": 10,
              "namespace": 11,
              "node": 5,
              "pod": 12,
              "port": 13,
              "prometheus": 14,
              "switch": 15,
              "switch_id": 1
            },
            "renameByName": {
              "Value": "Temperature",
              "device": "Remote port",
              "node": "Remote device"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 163
      },
      "id": 170,
      "panels": [],
      "title": "Selected Session - Systems - Warnings",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 164
      },
      "id": 195,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "Systems with components that may need attention, and link conditions that do not indicate immediate issues",
        "mode": "markdown"
      },
      "pluginVersion": "11.3.1",
      "title": "",
      "type": "text"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "System Health DB",
              "url": "d/df3huubwl3hfkd-internal/system-health-details?from=${__from}&to=${__to}&var-system=${__data.fields.system}"
            }
          ],
          "mappings": [],
          "noValue": "No degraded systems",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "0": {
                        "color": "#bf1aef",
                        "index": 2,
                        "text": "UNKNOWN"
                      },
                      "1": {
                        "color": "green",
                        "index": 3,
                        "text": "OK"
                      },
                      "2": {
                        "color": "dark-yellow",
                        "index": 4,
                        "text": "DEGRADED"
                      },
                      "3": {
                        "color": "red",
                        "index": 5,
                        "text": "CRITICAL"
                      },
                      "4": {
                        "color": "#18dbd680",
                        "index": 6,
                        "text": "CRITICAL_EMERGENCY_SHUTDOWN"
                      },
                      "5": {
                        "color": "super-light-blue",
                        "index": 7,
                        "text": "STANDBY"
                      },
                      "6": {
                        "color": "#0d7cea",
                        "index": 8,
                        "text": "PENDING_STANDBY"
                      },
                      "7": {
                        "color": "#12e280",
                        "index": 9,
                        "text": "PENDING_ACTIVE"
                      },
                      "8": {
                        "color": "#dbaa12",
                        "index": 10,
                        "text": "MISSING"
                      },
                      "9": {
                        "color": "#410be3",
                        "index": 11,
                        "text": "NO_POWER"
                      },
                      "10": {
                        "color": "#f1750a",
                        "index": 12,
                        "text": "HARDWARE_ERROR"
                      },
                      "11": {
                        "color": "super-light-orange",
                        "index": 13,
                        "text": "DISABLED"
                      },
                      "12": {
                        "color": "super-light-red",
                        "index": 14,
                        "text": "UNAVAILABLE"
                      },
                      "13": {
                        "color": "#be2b2b",
                        "index": 15,
                        "text": "UPDATING_SW"
                      },
                      "14": {
                        "color": "purple",
                        "index": 16,
                        "text": "PUMP_BLEEDING"
                      },
                      "15": {
                        "color": "blue",
                        "index": 17,
                        "text": "SERVICES_NOT_READY"
                      },
                      "16": {
                        "color": "light-blue",
                        "index": 18,
                        "text": "FPGA_UPDATE"
                      },
                      "17": {
                        "color": "#2eddcf",
                        "index": 19,
                        "text": "PUMP_LIMPING"
                      },
                      "18": {
                        "color": "#8ced0e",
                        "index": 20,
                        "text": "DOOR_OPEN"
                      },
                      "19": {
                        "color": "#0ecef8",
                        "index": 21,
                        "text": "DOOR_CLOSED"
                      },
                      "20": {
                        "index": 22,
                        "text": "NON_STANDARD"
                      },
                      "-1": {
                        "color": "#11469a",
                        "index": 1,
                        "text": "ADMIN_SVC_UNKNOWN"
                      },
                      "-2": {
                        "color": "#ed0a0a",
                        "index": 0,
                        "text": "SYSTEM_NOT_REACHABLE"
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 16,
        "w": 9,
        "x": 0,
        "y": 166
      },
      "id": 149,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 1,
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "flaps"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "(system_subsystem_health{system=~\"$systems\"} != 20) * on (system) group_left () (system_overall_health{system=~\"$systems\"} == bool 2) >= 2",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Degraded systems",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "prometheus": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 7,
              "instance": 1,
              "job": 2,
              "namespace": 3,
              "prometheus": 4,
              "subsystem": 6,
              "system": 5
            },
            "renameByName": {
              "Value": "State"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "red",
            "mode": "fixed"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/cehh15ni8ip6oa-internal/system-port-details?from=${__from}&to=${__to}&var-system=${__data.fields.system}&var-port=${__data.fields.port}"
            }
          ],
          "mappings": [],
          "noValue": "Healthy",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red"
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 16,
        "w": 5,
        "x": 9,
        "y": 166
      },
      "id": 110,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Errors"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "increase(system_network_rx_pkt_bad_fcs{system=~\"$systems\"}[$__range]) > 0",
          "format": "table",
          "instant": true,
          "legendFormat": "{{system}}",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Systems with CRC Errors",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "prometheus": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 7,
              "instance": 1,
              "job": 2,
              "namespace": 3,
              "port": 6,
              "prometheus": 4,
              "system": 5
            },
            "renameByName": {
              "Value": "Errors"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "red",
            "mode": "fixed"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/cehh15ni8ip6oa-internal/system-port-details?from=${__from}&to=${__to}&var-system=${__data.fields.system}&var-port=${__data.fields.port}"
            }
          ],
          "mappings": [],
          "noValue": "Healthy",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red"
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "port"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 78
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 16,
        "w": 5,
        "x": 14,
        "y": 166
      },
      "id": 171,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Errors"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "increase(system_network_rx_fec_corrected_pkts{system=~\"$systems\"}[$__range]) > 0",
          "format": "table",
          "instant": true,
          "legendFormat": "{{system}}",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Systems with FEC Corrected Errors",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "prometheus": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 7,
              "instance": 1,
              "job": 2,
              "namespace": 3,
              "port": 5,
              "prometheus": 6,
              "system": 4
            },
            "renameByName": {
              "Value": "Errors"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "red",
            "mode": "fixed"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/cehh15ni8ip6oa-internal/system-port-details?from=${__from}&to=${__to}&var-system=${__data.fields.system}&var-port=${__data.fields.port}"
            }
          ],
          "mappings": [],
          "noValue": "Healthy",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red"
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "port"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 70
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 16,
        "w": 5,
        "x": 19,
        "y": 166
      },
      "id": 172,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Errors"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "increase(system_network_rx_fec_uncorrected_pkts{system=~\"$systems\"}[$__range]) > 0",
          "format": "table",
          "instant": true,
          "legendFormat": "{{system}}",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Systems with FEC Uncorrected",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "prometheus": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 7,
              "instance": 1,
              "job": 2,
              "namespace": 3,
              "port": 6,
              "prometheus": 4,
              "system": 5
            },
            "renameByName": {
              "Value": "Errors"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "noValue": "No Errors",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "transparent"
              },
              {
                "color": "semi-dark-orange",
                "value": 1
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Glitch"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 84
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "color-background"
                }
              },
              {
                "id": "noValue",
                "value": "0"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Current"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 84
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "color-background"
                }
              },
              {
                "id": "noValue",
                "value": "0"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "System"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 200
              },
              {
                "id": "links",
                "value": [
                  {
                    "targetBlank": true,
                    "title": "System Health: ${__data.fields.System}",
                    "url": "/d/df3huubwl3hfkd-internal/system-health-details?${__url_time_range}&var-system=${__data.fields.System}"
                  }
                ]
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Voltage"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 84
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "applyToRow": false,
                  "mode": "basic",
                  "type": "color-background",
                  "wrapText": false
                }
              },
              {
                "id": "noValue",
                "value": "0"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 10,
        "w": 9,
        "x": 0,
        "y": 182
      },
      "id": 212,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "editorMode": "code",
          "exemplar": false,
          "expr": "count by (system) (max_over_time(system_dev_stats{system=~\"$systems\", component=~\"^GLTCH_(EXCUR|TRANS).*\"}[$__range]) > $glitch_thresh)",
          "format": "table",
          "instant": true,
          "interval": "",
          "legendFormat": "__auto",
          "range": false,
          "refId": "Glitch"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count by (system) (max_over_time(system_dev_stats{system=~\"$systems\", component=~\"^VDDC.*_IOUT\"}[$__range]) > $current_thresh)",
          "format": "table",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "__auto",
          "range": false,
          "refId": "Current"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "count by (system) (max_over_time(system_dev_stats{system=~\"$systems\", component=~\"^VDDC_ASIC.*\"}[$__range]) > $voltage_thresh)",
          "format": "table",
          "hide": false,
          "instant": true,
          "interval": "",
          "legendFormat": "__auto",
          "range": false,
          "refId": "Voltage"
        }
      ],
      "title": "Systems with Glitch or Power Events",
      "transformations": [
        {
          "id": "merge",
          "options": {}
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value #Current": 4,
              "Value #Glitch": 2,
              "Value #Voltage": 3,
              "system": 1
            },
            "renameByName": {
              "Value": "Number of Exceeding Glitch Counters",
              "Value #A": "Voltage",
              "Value #Current": "Current",
              "Value #Glitch": "Glitch",
              "Value #Voltage": "Voltage",
              "system": "System"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 192
      },
      "id": 168,
      "panels": [],
      "title": "Selected Session - Nodes - Warnings",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 193
      },
      "id": 194,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "Node conditions that do not indicate immediate issues",
        "mode": "markdown"
      },
      "pluginVersion": "11.3.1",
      "title": "",
      "type": "text"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Node Health",
              "url": "d/eehh0zde6wo3ka-internal/node-health-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}"
            }
          ],
          "mappings": [
            {
              "options": {
                "1": {
                  "index": 1,
                  "text": "Warning"
                },
                "2": {
                  "index": 0,
                  "text": "Error"
                }
              },
              "type": "value"
            }
          ],
          "noValue": "No IPMI warning conditions",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "CPU"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 56
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Fan"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 62
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Memory"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 88
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Thermal"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 74
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Power Supply"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 109
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "node"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 309
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Storage"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 83
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 16,
        "w": 10,
        "x": 0,
        "y": 195
      },
      "id": 199,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "frameIndex": 5,
        "showHeader": true,
        "sortBy": []
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"CPU\", node=~\"$nodes\"} == 1 or node_ipmi_health_status{category=\"Processor\", node=~\"$nodes\"} == 1",
          "format": "table",
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "CPU"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Fan\", node=~\"$nodes\"}  == 1",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Fan"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Memory\", node=~\"$nodes\"}  == 1",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Memory"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Temperatures\", node=~\"$nodes\"}  == 1",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Thermal"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Power supply\", node=~\"$nodes\"}  == 1",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "PSU"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Overall\", node=~\"$nodes\"} == 1",
          "format": "table",
          "hide": true,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Overall"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "node_ipmi_health_status{category=\"Storage\", node=~\"$nodes\"}  == 1",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "Storage"
        }
      ],
      "title": "IPMI",
      "transformations": [
        {
          "id": "seriesToRows",
          "options": {}
        },
        {
          "disabled": true,
          "id": "merge",
          "options": {}
        },
        {
          "id": "joinByField",
          "options": {
            "byField": "node",
            "mode": "outer"
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "Time 1": true,
              "Time 2": true,
              "Time 3": true,
              "Time 4": true,
              "Time 5": true,
              "Value #Overall": false,
              "__name__": true,
              "__name__ 1": true,
              "__name__ 2": true,
              "__name__ 3": true,
              "__name__ 4": true,
              "__name__ 5": true,
              "category": true,
              "category 1": true,
              "category 2": true,
              "category 3": true,
              "instance": true,
              "instance 1": true,
              "instance 2": true,
              "instance 3": true,
              "instance 4": true,
              "instance 5": true,
              "job": true,
              "job 1": true,
              "job 2": true,
              "job 3": true,
              "job 4": true,
              "job 5": true,
              "namespace": true,
              "namespace 1": true,
              "namespace 2": true,
              "namespace 3": true,
              "namespace 4": true,
              "namespace 5": true,
              "prometheus": true,
              "prometheus 1": true,
              "prometheus 2": true,
              "prometheus 3": true,
              "prometheus 4": true,
              "prometheus 5": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value #Fan": 7,
              "Value #Memory": 8,
              "Value #Overall": 11,
              "Value #PSU": 9,
              "Value #Storage": 10,
              "__name__": 2,
              "instance": 3,
              "job": 4,
              "namespace": 5,
              "node": 1,
              "prometheus": 6
            },
            "renameByName": {
              "Value #A": "CPU",
              "Value #B": "Fan",
              "Value #C": "Memory",
              "Value #CPU": "CPU",
              "Value #D": "Thermal",
              "Value #E": "Power Supply",
              "Value #Fan": "Fan",
              "Value #Memory": "Memory",
              "Value #Overall": "Overall",
              "Value #PSU": "Power Supply",
              "Value #Storage": "Storage",
              "Value #Thermal": "Thermal"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Node NIC Corrected FEC Errors",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "red",
            "mode": "fixed"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/aehh1fckgpjpca-internal/node-port-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}&var-interface=${__data.fields.interface}"
            }
          ],
          "mappings": [],
          "noValue": "No Errors",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 7,
        "x": 10,
        "y": 195
      },
      "id": 169,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Errors"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "increase(node_nic_stats_rx_corrected_bits_phy{node=~\"$nodes\"}[$__range]) > 0",
          "format": "table",
          "instant": true,
          "legendFormat": "{{node}}:{{interface}}",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Node FEC Corrected Errors",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "container": true,
              "endpoint": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "pod": true,
              "prometheus": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 10,
              "container": 1,
              "endpoint": 2,
              "instance": 3,
              "interface": 7,
              "job": 4,
              "namespace": 5,
              "node": 6,
              "pod": 8,
              "prometheus": 9
            },
            "renameByName": {
              "Value": "Errors"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "red",
            "mode": "fixed"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/aehh1fckgpjpca-internal/node-port-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}&var-interface=${__data.fields.interface}"
            }
          ],
          "mappings": [],
          "noValue": "No Errors",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 7,
        "x": 17,
        "y": 195
      },
      "id": 166,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Errors"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "increase(node_nic_stats_rx_crc_errors_phy{node=~\"$nodes\"}[$__range]) > 0",
          "format": "table",
          "instant": true,
          "legendFormat": "{{node}}:{{interface}}",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Node CRC Errors (Increase During Time Range)",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "container": true,
              "endpoint": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "pod": true,
              "prometheus": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 10,
              "container": 1,
              "endpoint": 2,
              "instance": 3,
              "interface": 5,
              "job": 6,
              "namespace": 7,
              "node": 4,
              "pod": 8,
              "prometheus": 9
            },
            "renameByName": {
              "Value": "Errors"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Node NIC uncorrectable packet errors can cause port flaps or other network failures",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "red",
            "mode": "fixed"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/aehh1fckgpjpca-internal/node-port-details?from=${__from}&to=${__to}&var-node=${__data.fields.node}&var-interface=${__data.fields.interface}"
            }
          ],
          "mappings": [],
          "noValue": "No Errors",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 7,
        "x": 10,
        "y": 203
      },
      "id": 167,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Errors"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "increase(node_nic_stats_rx_pcs_symbol_err_phy{node=~\"$nodes\"}[$__range]) > 0",
          "format": "table",
          "instant": true,
          "legendFormat": "{{node}}:{{interface}}",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Node FEC Uncorrected Errors",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "container": true,
              "endpoint": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "pod": true,
              "prometheus": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 10,
              "container": 1,
              "endpoint": 2,
              "instance": 3,
              "interface": 7,
              "job": 4,
              "namespace": 5,
              "node": 6,
              "pod": 8,
              "prometheus": 9
            },
            "renameByName": {
              "Value": "Errors"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 211
      },
      "id": 176,
      "panels": [],
      "title": "Selected Session - Switches - Warning",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 212
      },
      "id": 196,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "Switch conditions that do not indicate immediate issues",
        "mode": "markdown"
      },
      "pluginVersion": "11.3.1",
      "title": "",
      "type": "text"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Average and top 3 warmest NICs",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/dehh10cie0o3ka-internal/switch-port-details?from=${__from}&to=${__to}&var-switch=${__data.fields.switch_id}&var-port=${__data.fields.ifName}"
            }
          ],
          "mappings": [],
          "noValue": "No optics overtemp warnings",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "celsius"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 17,
        "x": 0,
        "y": 214
      },
      "id": 177,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Temperature"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "label_replace(label_replace(linkmon_switch_opt_temperature{switch=~\"$switches\"} > 0 , \"ifName\", \"$1\", \"port\", \"(.*)\"), \"switch_id\", \"$1\", \"switch\", \"(.*)\") * on (ifName, switch_id) group_left (conn_type, node, device) interface_watch_list{switch_id=~\".*\", node=\"$nodes|$switches|$systems\"} > 70",
          "format": "table",
          "hide": false,
          "instant": true,
          "legendFormat": "avg",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Optics over warning threshold temp",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "container": true,
              "desc": true,
              "endpoint": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "pod": true,
              "port": true,
              "prometheus": true,
              "switch": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 16,
              "conn_type": 3,
              "container": 4,
              "desc": 7,
              "device": 6,
              "endpoint": 8,
              "ifName": 2,
              "instance": 9,
              "job": 10,
              "namespace": 11,
              "node": 5,
              "pod": 12,
              "port": 13,
              "prometheus": 14,
              "switch": 15,
              "switch_id": 1
            },
            "renameByName": {
              "Value": "Temperature",
              "device": "Remote port",
              "node": "Remote device"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/dehh10cie0o3ka-internal/switch-port-details?from=${__from}&to=${__to}&var-switch=${__data.fields.switch}&var-port=${__data.fields.port}"
            }
          ],
          "mappings": [],
          "noValue": "No Errors",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 13,
        "w": 8,
        "x": 0,
        "y": 222
      },
      "id": 178,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Errors"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "increase(linkmon_switch_crc_errors{switch=~\"$switches\"}[$__range]) * on (switch, port) group_left label_replace(label_replace(interface_watch_list{switch_id=~\"$switches\", node=~\"$nodes|$systems|$switches\"}, \"port\", \"$1\", \"ifName\", \"(.*)\"), \"switch\", \"$1\", \"switch_id\", \"(.*)\") > 0",
          "format": "table",
          "instant": true,
          "legendFormat": "{{switch}}:{{port}} ({{desc}})",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Switch CRC Errors (Increase During Time Range)",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "container": true,
              "desc": true,
              "endpoint": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "pod": true,
              "prometheus": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 11,
              "container": 1,
              "desc": 2,
              "endpoint": 3,
              "instance": 4,
              "job": 5,
              "namespace": 6,
              "pod": 7,
              "port": 10,
              "prometheus": 8,
              "switch": 9
            },
            "renameByName": {
              "Value": "Errors"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/dehh10cie0o3ka-internal/switch-port-details?from=${__from}&to=${__to}&var-switch=${__data.fields.switch}&var-port=${__data.fields.port}"
            }
          ],
          "mappings": [],
          "noValue": "No Errors",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 13,
        "w": 8,
        "x": 8,
        "y": 222
      },
      "id": 179,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Errors"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "increase(linkmon_switch_fec_corrected_codewords{switch=~\"$switches\"}[$__range]) * on (switch, port) group_left label_replace(label_replace(interface_watch_list{switch_id=\"$switches\", node=\"$nodes|$systems|$switches\"}, \"port\", \"$1\", \"ifName\", \"(.*)\"), \"switch\", \"$1\", \"switch_id\", \"(.*)\") > 0",
          "format": "table",
          "instant": true,
          "legendFormat": "{{switch}}:{{port}} ({{desc}})",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Switch FEC Corrected Errors",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "container": true,
              "desc": true,
              "endpoint": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "pod": true,
              "prometheus": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 11,
              "container": 1,
              "desc": 2,
              "endpoint": 3,
              "instance": 4,
              "job": 5,
              "namespace": 6,
              "pod": 7,
              "port": 10,
              "prometheus": 8,
              "switch": 9
            },
            "renameByName": {
              "Value": "Errors"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "links": [
            {
              "targetBlank": true,
              "title": "Port Details",
              "url": "/d/dehh10cie0o3ka-internal/switch-port-details?from=${__from}&to=${__to}&var-switch=${__data.fields.switch}&var-port=${__data.fields.port}"
            }
          ],
          "mappings": [],
          "noValue": "No Errors",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 13,
        "w": 8,
        "x": 16,
        "y": 222
      },
      "id": 180,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Errors"
          }
        ]
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "increase(linkmon_switch_fec_uncorrected_codewords{switch=~\"$switches\"}[$__range]) * on (switch, port) group_left label_replace(label_replace(interface_watch_list{switch_id=~\"$switches\", node=~\"$nodes|$systems|$switches\"}, \"port\", \"$1\", \"ifName\", \"(.*)\"), \"switch\", \"$1\", \"switch_id\", \"(.*)\") > 0",
          "format": "table",
          "instant": true,
          "legendFormat": "{{switch}}:{{port}} ({{desc}})",
          "range": false,
          "refId": "A"
        }
      ],
      "title": "Switch FEC Uncorrected Errors",
      "transformations": [
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time": true,
              "container": true,
              "desc": true,
              "endpoint": true,
              "instance": true,
              "job": true,
              "namespace": true,
              "pod": true,
              "prometheus": true
            },
            "includeByName": {},
            "indexByName": {
              "Time": 0,
              "Value": 11,
              "container": 1,
              "desc": 2,
              "endpoint": 3,
              "instance": 4,
              "job": 5,
              "namespace": 6,
              "pod": 7,
              "port": 10,
              "prometheus": 8,
              "switch": 9
            },
            "renameByName": {
              "Value": "Errors"
            }
          }
        }
      ],
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 235
      },
      "id": 143,
      "panels": [],
      "title": "Selected Session - Systems - Error History",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 2,
        "w": 24,
        "x": 0,
        "y": 236
      },
      "id": 197,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "Historical view of error events",
        "mode": "markdown"
      },
      "pluginVersion": "11.3.1",
      "title": "",
      "type": "text"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "fillOpacity": 70,
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineWidth": 2,
            "spanNulls": false
          },
          "mappings": [
            {
              "options": {
                "0": {
                  "color": "#bf1aef",
                  "index": 2,
                  "text": "UNKNOWN"
                },
                "1": {
                  "color": "green",
                  "index": 3,
                  "text": "OK"
                },
                "2": {
                  "color": "dark-yellow",
                  "index": 4,
                  "text": "DEGRADED"
                },
                "3": {
                  "color": "red",
                  "index": 5,
                  "text": "CRITICAL"
                },
                "4": {
                  "color": "#18dbd680",
                  "index": 6,
                  "text": "CRITICAL_EMERGENCY_SHUTDOWN"
                },
                "5": {
                  "color": "super-light-blue",
                  "index": 7,
                  "text": "STANDBY"
                },
                "6": {
                  "color": "#0d7cea",
                  "index": 8,
                  "text": "PENDING_STANDBY"
                },
                "7": {
                  "color": "#12e280",
                  "index": 9,
                  "text": "PENDING_ACTIVE"
                },
                "8": {
                  "color": "#dbaa12",
                  "index": 10,
                  "text": "MISSING"
                },
                "9": {
                  "color": "#410be3",
                  "index": 11,
                  "text": "NO_POWER"
                },
                "10": {
                  "color": "#f1750a",
                  "index": 12,
                  "text": "HARDWARE_ERROR"
                },
                "11": {
                  "color": "super-light-orange",
                  "index": 13,
                  "text": "DISABLED"
                },
                "12": {
                  "color": "super-light-red",
                  "index": 14,
                  "text": "UNAVAILABLE"
                },
                "13": {
                  "color": "#be2b2b",
                  "index": 15,
                  "text": "UPDATING_SW"
                },
                "14": {
                  "color": "purple",
                  "index": 16,
                  "text": "PUMP_BLEEDING"
                },
                "15": {
                  "color": "blue",
                  "index": 17,
                  "text": "SERVICES_NOT_READY"
                },
                "16": {
                  "color": "light-blue",
                  "index": 18,
                  "text": "FPGA_UPDATE"
                },
                "17": {
                  "color": "#2eddcf",
                  "index": 19,
                  "text": "PUMP_LIMPING"
                },
                "18": {
                  "color": "#8ced0e",
                  "index": 20,
                  "text": "DOOR_OPEN"
                },
                "19": {
                  "color": "#0ecef8",
                  "index": 21,
                  "text": "DOOR_CLOSED"
                },
                "20": {
                  "index": 22,
                  "text": "NON_STANDARD"
                },
                "-1": {
                  "color": "#11469a",
                  "index": 1,
                  "text": "ADMIN_SVC_UNKNOWN"
                },
                "-2": {
                  "color": "#ed0a0a",
                  "index": 0,
                  "text": "SYSTEM_NOT_REACHABLE"
                }
              },
              "type": "value"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 17,
        "w": 13,
        "x": 0,
        "y": 238
      },
      "id": 146,
      "options": {
        "alignValue": "center",
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "showLegend": true
        },
        "mergeValues": true,
        "rowHeight": 1,
        "showValue": "auto",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "expr": "max(max_over_time(system_overall_health{system=~\"$systems\"}[10m]) != 1 and max_over_time(system_overall_health{system=~\"$systems\"}[10m]) != 2) by (system)",
          "instant": false,
          "legendFormat": "__auto",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Unusable Systems - history",
      "type": "state-timeline"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Counts of systems with partial or total network problems",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "fixed"
          },
          "custom": {
            "fillOpacity": 70,
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineWidth": 0,
            "spanNulls": false
          },
          "mappings": [
            {
              "options": {
                "1": {
                  "color": "semi-dark-red",
                  "index": 0,
                  "text": "Some port flaps"
                },
                "2": {
                  "color": "light-red",
                  "index": 1,
                  "text": "Some ports down"
                },
                "3": {
                  "color": "semi-dark-orange",
                  "index": 2,
                  "text": "All ports flapping"
                },
                "4": {
                  "color": "light-orange",
                  "index": 3,
                  "text": "All ports down"
                }
              },
              "type": "value"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 17,
        "w": 11,
        "x": 13,
        "y": 238
      },
      "id": 147,
      "options": {
        "alignValue": "left",
        "legend": {
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "mergeValues": true,
        "rowHeight": 0.9,
        "showValue": "auto",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "expr": "((count by (system) (group by (system, port) (increase(system_network_flap_count{system=~\"$systems\"}[15m]) > 2)) < bool 12)*1 or (count by (system) (group by (system, port) (min_over_time(system_network_health{system=~\"$systems\"}[$__rate_interval]) == 0)) < bool 12)*2 or ( count by (system) (group by (system, port) (increase(system_network_flap_count{system=~\"$systems\"}[15m]) > 2)) == bool 12)*3 or (count by (system) (group by (system, port) (min_over_time(system_network_health{system=~\"$systems\"}[$__rate_interval]) * on (system) group_left () group by (system) (((system_overall_health == bool 1) or (system_overall_health == bool 2)) > 0) == 0)) == bool 12)*4) > 0",
          "hide": false,
          "instant": false,
          "legendFormat": "__auto",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Port Errors",
      "type": "state-timeline"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 255
      },
      "id": 158,
      "panels": [],
      "title": "Selected Session - Nodes - Error History",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "NIC flapping or down",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "red",
            "mode": "fixed"
          },
          "custom": {
            "fillOpacity": 70,
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineWidth": 0,
            "spanNulls": false
          },
          "mappings": [
            {
              "options": {
                "1": {
                  "index": 0,
                  "text": "Error"
                }
              },
              "type": "value"
            }
          ],
          "min": 0,
          "noValue": "Healthy",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 17,
        "w": 12,
        "x": 0,
        "y": 256
      },
      "id": 165,
      "options": {
        "alignValue": "left",
        "legend": {
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "mergeValues": true,
        "rowHeight": 0.9,
        "showValue": "auto",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "(increase(interface_watch_list:status_changes_total{node=~\"$nodes\"}[15m])> bool 2) > 0",
          "hide": false,
          "interval": "",
          "legendFormat": "{{node}}:{{device}} flapping",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "exemplar": false,
          "expr": "(min_over_time(interface_watch_list:status{node=~\"$nodes\"}[$__rate_interval]) == bool 0) > 0",
          "hide": false,
          "interval": "",
          "legendFormat": "{{node}}:{{device}} down",
          "range": true,
          "refId": "B"
        }
      ],
      "title": "Node NIC Errors",
      "type": "state-timeline"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 273
      },
      "id": 181,
      "panels": [],
      "title": "Selected Session - Switches - Error History",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      },
      "description": "Time and duration of port issues (port is down or had one or more flaps) - only for explicitly tracked ports from the network_config.json",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "fixed"
          },
          "custom": {
            "fillOpacity": 70,
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineWidth": 0,
            "spanNulls": false
          },
          "mappings": [
            {
              "options": {
                "1": {
                  "color": "dark-red",
                  "index": 0,
                  "text": "down"
                }
              },
              "type": "value"
            },
            {
              "options": {
                "from": 2,
                "result": {
                  "color": "dark-yellow",
                  "index": 1,
                  "text": "flapping"
                },
                "to": 3
              },
              "type": "range"
            }
          ],
          "noValue": "Healthy",
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green"
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 13,
        "w": 24,
        "x": 0,
        "y": 274
      },
      "id": 182,
      "options": {
        "alignValue": "center",
        "legend": {
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "mergeValues": true,
        "rowHeight": 0.9,
        "showValue": "always",
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "11.3.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "prometheus"
          },
          "editorMode": "code",
          "expr": "(group by (ifName, switch_id) (min_over_time(ifOperStatus{switch_id=~\"$switches\"}[$__rate_interval])!=1) or (group by (ifName, switch_id) (changes(ifLastChange[10m])>0) * 2) or (group by (ifName, switch_id)  (label_replace(label_replace(((min_over_time(linkmon_switch_oper_status[$__rate_interval]) != 1)) or ((changes(linkmon_switch_carrier_changes[10m]) > 0) * 2) , \"ifName\", \"$1\", \"port\", \"(.*)\"), \"switch_id\", \"$1\", \"switch\", \"(.*)\")))) * on (ifName, switch_id) group_left (conn_type, node, device) interface_watch_list{switch_id=~\"$switches\", node=~\"$nodes|$systems|$switches\"}",
          "instant": false,
          "legendFormat": "{{conn_type}} {{switch_id}}:{{ifName}} ({{node}}:{{device}})",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Switch Port Errors",
      "type": "state-timeline"
    }
  ],
  "preload": false,
  "refresh": "",
  "schemaVersion": 40,
  "tags": [],
  "templating": {
    "list": [
      {
        "definition": "label_values(system_label,namespace)",
        "name": "session",
        "options": [],
        "query": {
          "qryType": 1,
          "query": "label_values(system_label,namespace)",
          "refId": "PrometheusVariableQueryEditor-VariableQuery"
        },
        "refresh": 2,
        "regex": "",
        "type": "query"
      },
      {
        "current": {
          "text": "All",
          "value": "$__all"
        },
        "definition": "query_result(node:namespace_group_role_info{namespace=\"$session\"})",
        "includeAll": true,
        "multi": true,
        "name": "nodes",
        "options": [],
        "query": {
          "qryType": 3,
          "query": "query_result(node:namespace_group_role_info{namespace=\"$session\"})",
          "refId": "PrometheusVariableQueryEditor-VariableQuery"
        },
        "refresh": 1,
        "regex": "/node=\"(?<text>[^\"]+)/g",
        "type": "query"
      },
      {
        "current": {
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "definition": "label_values(system_label{namespace=\"$session\"},system)",
        "includeAll": true,
        "multi": true,
        "name": "systems",
        "options": [],
        "query": {
          "qryType": 1,
          "query": "label_values(system_label{namespace=\"$session\"},system)",
          "refId": "PrometheusVariableQueryEditor-VariableQuery"
        },
        "refresh": 2,
        "regex": "",
        "type": "query"
      },
      {
        "current": {
          "text": "All",
          "value": "$__all"
        },
        "definition": "query_result(group by (switch_id) ((label_replace(system_label{namespace=\"$session\"}, \"node\", \"$1\", \"system\", \"(.*)\") or on (node) node:namespace_group_role_info{namespace=\"$session\"}) * on (node) group_right group by (node, switch_id) (interface_watch_list)))",
        "includeAll": true,
        "multi": true,
        "name": "switches",
        "options": [],
        "query": {
          "qryType": 3,
          "query": "query_result(group by (switch_id) ((label_replace(system_label{namespace=\"$session\"}, \"node\", \"$1\", \"system\", \"(.*)\") or on (node) node:namespace_group_role_info{namespace=\"$session\"}) * on (node) group_right group by (node, switch_id) (interface_watch_list)))",
          "refId": "PrometheusVariableQueryEditor-VariableQuery"
        },
        "refresh": 2,
        "regex": "/switch_id=\"(?<text>[^\"]+)/g",
        "type": "query"
      },
      {
        "current": {
          "text": "1",
          "value": "1"
        },
        "hide": 2,
        "name": "glitch_thresh",
        "options": [
          {
            "selected": true,
            "text": "1",
            "value": "1"
          }
        ],
        "query": "1",
        "type": "textbox"
      },
      {
        "current": {
          "text": "380",
          "value": "380"
        },
        "hide": 2,
        "name": "current_thresh",
        "options": [
          {
            "selected": true,
            "text": "380",
            "value": "380"
          }
        ],
        "query": "380",
        "type": "textbox"
      },
      {
        "current": {
          "text": "0.7",
          "value": "0.7"
        },
        "hide": 2,
        "name": "voltage_thresh",
        "options": [
          {
            "selected": true,
            "text": "0.7",
            "value": "0.7"
          }
        ],
        "query": "0.7",
        "type": "textbox"
      }
    ]
  },
  "time": {
    "from": "now-24h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "",
  "title": "Session Dashboard",
  "uid": "eedo3u14p4v7kb-internal",
  "version": 6,
  "weekStart": ""
}
