- name: Find backup files that are too old
  find:
    paths: "{{ dest_cluster_dir }}"
    patterns: "cluster.yaml.*~"
    age: 90d
  register: backup_cluster_yamls

- name: Clean up old backup files
  file:
    path: "{{ item.path }}"
    state: absent
  loop: "{{ backup_cluster_yamls.files }}"

- name: Find backup files that are too old
  find:
    paths: "{{ dest_cluster_dir }}"
    patterns: "nvme-targets.yaml.*~"
    age: 90d
  register: backup_nvme_targets_yamls

- name: Clean up old backup files
  file:
    path: "{{ item.path }}"
    state: absent
  loop: "{{ backup_nvme_targets_yamls.files }}"

